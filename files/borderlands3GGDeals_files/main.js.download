!function(t){!function(t){t.computedStyle=function(t){return t.currentStyle||window.getComputedStyle(t,null)},t.isOverflow=function(t){return t.scrollWidth>t.clientWidth},t.windowWidth=function(){return Math.max(window.innerWidth,document.documentElement.clientWidth)},t.createElementFromHTML=function(t){var e=document.createElement("div");return e.innerHTML=t.trim(),e.firstElementChild},t.setTitle=function(t,e){""===(e=e.trim())?(t.removeAttribute("title"),
t.removeAttribute("data-original-title")):(t.title=e,t.setAttribute("title",e))},t.executeScript=function(t){let e=document.createElement("script");e.id="flashes-script",e.type="text/javascript";let i=document.createElement("div");i.innerHTML=t,[...i.getElementsByTagName("script")].forEach(t=>{null!==t.getAttribute("type")&&"text/javascript"!==t.getAttribute("type")||(e.innerHTML+=t.innerHTML)}),e.innerHTML.trim().length&&(document.head.appendChild(e),document.head.removeChild(e))},
t.executeScriptFromJson=function(t){t.hasOwnProperty("__scripts")&&this.executeScript(t.__scripts)}}(t.Dom||(t.Dom={}))}(Helpers||(Helpers={})),function(t){!function(t){var e=Helpers.Dom.createElementFromHTML;t.sweetAlert=function(t="There was a problem with processing your request.<br>Please, try again."){swal({title:"Oops!",html:t,showConfirmButton:!1,showCancelButton:!1})};t.removeEnableBrowserPermissionAlert=function(){
t.alertManager.removeElement(document.querySelector(".browser-notifications-wrapper").parentElement)};t.alertManager=new class{constructor(t,e="alert"){this.alerts=[],this.isEmpty=!0,this.container=t,this.alertClass=e,this.alerts=Array.prototype.slice.call(t.getElementsByClassName(this.alertClass)),this.container.classList.add("init"),this.init()}init(){this.initAlertsEvents(),this.markLength()}initAlertsEvents(){for(var t,e=0;t=this.alerts[e];e++)this.registerEvents(t)}registerEvents(t){
$(t).on("closed.bs.alert",()=>this.onClose(t))}onClose(t){this.removeElement(t)}addAlertFromUrl(t,i="afterbegin"){$.get(t,t=>{this.addElement(e(t),i)})}addAlert(t,e="afterbegin"){this.addElement(t.element,e)}addElement(t,e="afterbegin"){this.container.insertAdjacentElement(e,t),this.isEmpty&&this.unmarkAsEmpty(),this.alerts.push(t),this.registerEvents(t)}remove(t){for(var e,i=this.container.querySelectorAll(t),s=0;e=i[s];s++)this.removeElement(e)}removeElement(t){t.remove(),
this.alerts.splice(this.alerts.indexOf(t),1),this.markLength()}markLength(){0===this.alerts.length?this.markAsEmpty():this.unmarkAsEmpty()}markAsEmpty(){this.container.classList.add("empty"),this.isEmpty=!0}unmarkAsEmpty(){this.container.classList.remove("empty"),this.isEmpty=!1}}(document.getElementById("flash-container"))}(t.Alert||(t.Alert={}))}(Component||(Component={})),function(t){!function(e){
const i="css-user-wishlist-games",s="css-user-ignorelist-games",a="css-user-collection-games",n="css-user-alert-games";function r(e){this.setTimeout(()=>{var i=document.getElementById(e);if(null!==i){var s=i.getAttribute("href");s=s.split("?v=")[0]+"?v=t-"+Date.now();var a=document.createElement("link");a.setAttribute("rel","stylesheet"),a.setAttribute("type","text/css"),a.setAttribute("href",s),a.setAttribute("id",e),a.onload=function(){i.remove(),t.User.initActiveIcons("body")},
document.getElementsByTagName("head")[0].appendChild(a)}},200)}e.reloadWishlistCss=function(){r(i)},e.reloadCollectionCss=function(){r(a)},e.reloadAlertsCss=function(){r(n)},e.reloadIgnorelistCss=function(){r(s)}}(t.Assets||(t.Assets={}))}(Component||(Component={})),function(t){!function(t){t.BrowserNotification=class{static browserSupport(){return"Notification"in window}static isGranted(){return!!this.browserSupport()&&"granted"===Notification.permission}static pushNotification(t,e){e||(e={}),
e.icon=t.icon,e.body=t.body,new Notification(t.title,e).onclick=function(){window.location.href=t.url}}},t.isFirefox=function(){return"Firefox"===(e=navigator.userAgent,i=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],/trident/i.test(i[1])?{name:"IE",version:(t=/\brv[ :]+(\d+)/g.exec(e)||[])[1]||""}:"Chrome"===i[1]&&null!=(t=e.match(/\bOPR|Edge\/(\d+)/))?{name:"Opera",version:t[1]}:(i=i[2]?[i[1],i[2]]:[navigator.appName,navigator.appVersion,"-?"],
null!=(t=e.match(/version\/(\d+)/i))&&i.splice(1,1,t[1]),{name:i[0],version:i[1]})).name;var t,e,i}}(t.Notifications||(t.Notifications={}))}(Component||(Component={})),function(t){!function(t){var e=Helpers.Dom.computedStyle;class i{constructor(t){this.node=t}isActive(){return this.node.classList.contains("active")}static createMultiple(t){for(var e=[],i=0;i<t.length;i++)e.push(this.createAction(t[i]));return e}static createAction(t){return new i(t)}active(){this.node.classList.add("active")}
deactivate(){this.node.classList.remove("active")}}class s extends i{static createAction(t){return new s(t)}isActive(){return"none"!==e(this.node).display}isOwnedActive(){return this.isActive()&&this.isOwned()}isOwned(){return this.parentHasClass(s.CLASS_ACTION_OWNED)}isAlertedActive(){return this.isActive()&&this.isAlerted()}isAlerted(){return this.parentHasClass(s.CLASS_ACTION_ALERTED)}isWishlistedActive(){return this.isActive()&&this.isWishlist()}isWishlist(){
return this.parentHasClass(s.CLASS_ACTION_WISHLIST)}isIgnoredActive(){return this.isActive()&&this.isIgnorelist()}isIgnorelist(){return this.parentHasClass(s.CLASS_ACTION_IGNORELIST)}parentHasClass(t){return this.node.parentElement.classList.contains(t)}updateCounter(t,e){let i=this.node.querySelector(".user-count .count");i&&(i.textContent=String(t));let s=this.node.querySelector(".user-count .count-short");s&&(s.textContent=String(e))}}s.DEACTIVATE_CLASS="deactivate",
s.CLASS_ACTION_OWNED="owned-game",s.CLASS_ACTION_ALERTED="alerted-game",s.CLASS_ACTION_WISHLIST="wishlisted-game",s.CLASS_ACTION_IGNORELIST="ignored-game";class a{constructor(t,e){this.container=t,this.actions=e}updateStatus(){this.hasActiveAction()?this.activate():this.deactivate()}hasActiveAction(){return this.actions.some(t=>t.isActive())}activate(){a.activateContainer(this.container)}deactivate(){a.deactivateContainer(this.container)}static activateAllContainers(t){
t.forEach(t=>this.activateContainer(t))}static deactivateAllContainers(t){t.forEach(t=>this.deactivateContainer(t))}static activateContainer(t){t.classList.add("active")}static deactivateContainer(t){t.classList.remove("active")}}class n extends a{constructor(t,e){super(t,e),this.countersUrl=t.getAttribute("data-counters-url"),this.gameId=this.container.getAttribute(n.GAME_ID_ATTRIBUTE)}static create(t){return new this(t,s.createMultiple(t.getElementsByClassName(s.DEACTIVATE_CLASS)))}
updateStatus(){super.updateStatus(),this.updateWishlisted(),this.updateIgnored(),this.updateOwned(),this.updateAlerted()}updateCounters(){if(null!==this.countersUrl){let t=new XMLHttpRequest;t.open("GET",this.countersUrl,!0),t.responseType="json",t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.onload=(()=>{if(200===t.status){let e=t.response;s.createMultiple(this.container.getElementsByClassName(n.ACTION_CLASS)).forEach(t=>{
t.isAlerted()?t.updateCounter(e.alerts,e.alertsShort):t.isOwned()?t.updateCounter(e.collection,e.collectionShort):t.isWishlist()?t.updateCounter(e.wishlist,e.wishlistShort):t.isIgnorelist()&&t.updateCounter(e.ignorelist,e.ignorelistShort)})}}),t.send()}}updateOwned(){this.isOwned()?n.markAsOwned(this.gameId):n.unmarkAsOwned(this.gameId)}isOwned(){return this.actions.some(t=>t.isOwnedActive())}updateAlerted(){this.isAlerted()?n.markAsAlerted(this.gameId):n.unmarkAsAlerted(this.gameId)}
isAlerted(){return this.actions.some(t=>t.isAlertedActive())}updateWishlisted(){this.isWishlisted()?n.markAsWishlisted(this.gameId):n.unmarkAsWishlisted(this.gameId)}isWishlisted(){return this.actions.some(t=>t.isWishlistedActive())}updateIgnored(){this.isIgnored()?n.markAsIgnored(this.gameId):n.unmarkAsIgnored(this.gameId)}isIgnored(){return this.actions.some(t=>t.isIgnoredActive())}static updateGameCounters(t){var e=this.SELECTOR_ACTIONS+"-"+t;document.querySelectorAll(e).forEach(function(t){
n.create(t).updateCounters()},this)}static getGameSelector(t){return"["+this.CONTAINER_GAME_ID_ATTRIBUTE+'="'+t+'"]'}static getGamesContainers(t){return document.querySelectorAll(this.getGameSelector(t)+":not(.keep-unmarked-container)")}static markAsOwned(t){this.getGamesContainers(t).forEach(t=>t.classList.add(this.OWNED_CLASS))}static unmarkAsOwned(t){this.getGamesContainers(t).forEach(t=>t.classList.remove(this.OWNED_CLASS))}static markAsWishlisted(t){
this.getGamesContainers(t).forEach(t=>t.classList.add(this.WISHLISTED_CLASS))}static unmarkAsWishlisted(t){this.getGamesContainers(t).forEach(t=>t.classList.remove(this.WISHLISTED_CLASS))}static markAsAlerted(t){this.getGamesContainers(t).forEach(t=>t.classList.add(this.ALERTED_CLASS))}static unmarkAsAlerted(t){this.getGamesContainers(t).forEach(t=>t.classList.remove(this.ALERTED_CLASS))}static markAsIgnored(t){this.getGamesContainers(t).forEach(t=>t.classList.add(this.IGNORED_CLASS))}
static unmarkAsIgnored(t){this.getGamesContainers(t).forEach(t=>t.classList.remove(this.IGNORED_CLASS))}}n.SELECTOR_ACTIONS=".game-collection-actions",n.CONTAINER_GAME_ID_ATTRIBUTE="data-container-game-id",n.ACTION_CLASS="game-action",n.GAME_ID_ATTRIBUTE="data-game-id",n.WISHLISTED_CLASS="wishlisted",n.OWNED_CLASS="owned",n.ALERTED_CLASS="alerted",n.IGNORED_CLASS="ignored",t.GameActions=n,t.initActiveIcons=function(t){document.querySelectorAll(function(t){
var e="["+n.CONTAINER_GAME_ID_ATTRIBUTE+"] "+n.SELECTOR_ACTIONS;return t?t+" "+e:e}(t)).forEach(t=>{n.create(t).updateStatus()})}}(t.User||(t.User={}))}(Component||(Component={})),function(t){!function(t){t.isEmpty=function(t){for(let e in t)if(t.hasOwnProperty(e))return!1;return!0},t.isUndefined=function(t){return void 0===t}}(t.Object||(t.Object={}))}(Helpers||(Helpers={}));var Component,Data,Helpers,Forms,Utils,SyncWidget,Widgets,isUndefined=Helpers.Object.isUndefined;!function(t){
t.fn.update=function(){var e,i=t(this.selector);for(e=0;e<i.length;e++)this[e]=i[e];for(;e<this.length;e++)this[e]=void 0;return this.length=i.length,this},t.fn.setInlineImageBackgroundFromImg=function(t){if(t.length){var e=t.attr("data-src");isUndefined(e)||this.setInlineImageBackground(e)}},t.fn.setInlineImageBackground=function(t){this.addClass("bg-set"),this.css("backgroundImage","url("+t+")")},t.fn.isInViewport=function(){
var e=t(this).offset().top,i=e+t(this).outerHeight(),s=t(window).scrollTop(),a=s+t(window).height();return i>s&&e<a}}(jQuery),function(t){!function(t){class e{constructor(t){this.openBodyClass=[],this.$filter=t.closest(e.SELECTOR_DROPDOWN),this.filter=this.$filter[0],this.$current=t,this.$content=this.$filter.find("[data-content]").first(),this.openBodyClass=this.filter.getAttribute("data-open-body-class").split(" "),this.autoMargin=this.filter.hasAttribute("data-auto-margin")}
static findParent(t){return t.closest(this.SELECTOR_DROPDOWN)}static init(){this.existDropdowns()&&(this.initCloseDropdownOnClick(),this.initDropdownClick())}static existDropdowns(){return $(this.SELECTOR_DROPDOWN).length>0}static initCloseDropdownOnClick(){jQuery(document).on("click",this.SELECTOR_CLOSE_OPEN,()=>this.closeOpenFilterDropdown()),jQuery(document).on("click",()=>this.closeOpenFilterDropdown()),jQuery(document).on("click",this.SELECTOR_DROPDOWN,function(t){t.stopPropagation()})}
static initDropdownClick(){jQuery(document).on("click",this.getClickSelector(),t=>this.onClick(t))}static getClickSelector(){return this.SELECTOR_DROPDOWN+" "+this.SELECTOR_TOGGLE}static onClick(t){var i=$(t.currentTarget);if(!i.hasClass("clear-all-filters")&&!i.parent().hasClass("disabled")){var s=new e(i);s.isOpen()?s.onClose():(s.isChildrenForOpen()||this.closeOpenFilterDropdown(),s.onOpen())}}isOpen(){return this.filter.classList.contains(e.OPEN_FILTER_CLASS)}isChildrenForOpen(){
return e.findOpenFilter().find(this.$filter).length>0}static closeOpenFilterDropdown(){if(!document.body.classList.contains(this.BODY_CLASS_BLOCK_OPEN)){let t=this.findOpenFilter();if(t.length){new e(t).onClose()}}}static findOpenFilter(){return $(this.getOpenFilterSelector())}static getOpenFilterSelector(){return this.SELECTOR_DROPDOWN+"."+this.OPEN_FILTER_CLASS}onClose(){this.$filter.trigger("close"),this.openBodyClass.length&&document.body.classList.remove(...this.openBodyClass),
this.autoMargin&&this.clearMargin(),this.close()}close(){this.filter.classList.remove(e.OPEN_FILTER_CLASS)}open(){this.filter.dispatchEvent(new Event(e.OPEN_EVENT)),this.$filter.trigger("open"),this.filter.classList.add(e.OPEN_FILTER_CLASS)}clearMargin(){this.setMargin(0)}onOpen(){this.open(),this.openBodyClass.length&&document.body.classList.add(...this.openBodyClass),e.isDesktopView()&&this.autoMargin&&this.setMargin(this.calculateMargin())}static isDesktopView(){
return $(window).width()>this.MOBILE_WIDTH}calculateMargin(){return i.calculate(this.$content.width(),this.$content.offset().left)}setMargin(t){this.$content.css("margin-left",-t),this.$content.find(".arrow").css("margin-left",t)}}e.SELECTOR_DROPDOWN=".filter-dropdown",e.SELECTOR_TOGGLE=".current",e.OPEN_FILTER_CLASS="open",e.SELECTOR_CLOSE_OPEN=".close-open-dropdown",e.MOBILE_WIDTH=1014,e.BODY_CLASS_BLOCK_OPEN="not-close-open-dropdown",e.OPEN_EVENT="dropdown.open",t.FilterDropdown=e;class i{
static calculate(t,e){var i=this.getRightExcess(t,e);return i>0?i:(i=this.getLeftExcess(e))<0?i:0}static getRightExcess(t,e){return this.sideMargin+e+t-this.getWindowWidth()}static getWindowWidth(){return $(window).width()}static getLeftExcess(t){return t-this.sideMargin}}i.sideMargin=15,$(function(){e.init()})}(t.Filter||(t.Filter={}))}(Forms||(Forms={})),function(t){var e=Helpers.Object.isUndefined;t.autoScrollWhenActiveIsOver=function(t,e){let s=new i(t,e);s.activeIsOver()&&s.center()}
;class i{constructor(t,e){this.leftOffset=16,this.selector=document.querySelector(t),this.setOptions(e||{}),this.options.onResize&&window.addEventListener("afterWidthChange",()=>this.center())}setOptions(t){e(t.itemClass)&&(t.itemClass="active"),e(t.onResize)&&(t.onResize=!0),this.options=t}center(){let t=this.getActiveElement();null!==t&&(this.selector.scrollLeft=this.getLeftOffset(t)-this.getCenterOffset(t))}getCenterOffset(t){return(this.selector.clientWidth-t.clientWidth)/2}activeIsOver(){
let t=this.getActiveElement();return null!==t&&this.getLeftOffset(t)+t.clientWidth>this.selector.clientWidth}scrollActive(t){let e=this.getActiveElement();null!==e&&(this.selector.scrollLeft=this.getLeftOffset(e)-t)}getLeftOffset(t){return this.selector.scrollLeft+t.getBoundingClientRect().left}getActiveElement(){var t=this.selector.getElementsByClassName(this.options.itemClass);return t.length?t[0]:null}}t.AutoScroll=i}(Widgets||(Widgets={})),function(t){!function(t){
var e=Helpers.Dom.isOverflow,i=Forms.Filter.FilterDropdown;let s=[];function a(t,i={onlyOverflowed:!1}){return i.onlyOverflowed&&(t=t.filter(t=>e(t))),delete i.onlyOverflowed,t.length?function(t,e){return OverlayScrollbars(t,e)}(t,i):[]}t.initOnDropdownFilterOpen=function(t,e){t.forEach(function(t){let n=i.findParent(t);n&&n.addEventListener(i.OPEN_EVENT,()=>{-1===s.indexOf(t)&&(s.push(t),a([t],e))})})},t.init=a}(t.Scroller||(t.Scroller={}))}(Widgets||(Widgets={})),function(t){!function(t){
var e=Helpers.Dom.isOverflow;const i="data-mark-overflow",s="data-overflow-event",a="is-overflow",n="not-overflow";function r(t){return e(t)?(t.hasAttribute(s)&&t.dispatchEvent(new Event(a)),!0):(t.hasAttribute(s)&&t.dispatchEvent(new Event(n)),!1)}t.init=function(){!function(){document.addEventListener("DOMContentLoaded",()=>this.markElements()),window.addEventListener("afterWidthChange",()=>{!function(t){for(var e,s=function(t){
return t?document.querySelectorAll(t+" ["+i+"]"):document.querySelectorAll(i)}(t),a=0;e=s[a];a++)r(e)}()})}()},t.mark=r}(t.Overflow||(t.Overflow={}))}(Widgets||(Widgets={})),function(t){!function(t){var e=Widgets.Overflow.mark;const i="[data-title-auto-hide]";t.AutoHide=class{static init(){this.registerEvents(),this.autoHide()}static autoHide(t){for(var e,i=this.getElements(t),s=0;e=i[s];s++)this.parseElement(e)}static registerEvents(){window.addEventListener("afterWidthChange",()=>{
this.autoHide()})}static getElements(t){return t?document.querySelectorAll(t+" "+i):document.querySelectorAll(i)}static parseElement(t){e(t)?(t.setAttribute("data-original-title",t.getAttribute("data-title-auto-hide")),t.setAttribute("title",t.getAttribute("data-title-auto-hide"))):(t.setAttribute("data-original-title",""),t.setAttribute("title",""))}},t.hideTooltips=function(){$(".tippy-popper").remove()}}(t.Tooltip||(t.Tooltip={}))}(Component||(Component={})),function(t){!function(e){
var i=t.Tooltip.hideTooltips;class s{constructor(t,e){this.collapse=null,this.scroll=null,this.modal=document.querySelector(t),this.selector=t,this.$modal=$(this.modal),this.animateClass=e}init(){this.$modal.on("show.bs.modal",t=>this.onShow(t)),this.$modal.on("hide.bs.modal",t=>this.onHide(t)),this.$modal.on("hidden.bs.modal",()=>this.onHidden()),window.addEventListener("resize",()=>{this.checkOverflowedHeight()})}getCollapse(){return this.collapse}onShow(t){var e=$(t.relatedTarget)[0];if(e){
if(e.classList.contains("disabled"))return t.stopImmediatePropagation(),void t.preventDefault();e.hasAttribute("data-url")&&(this.url=e.getAttribute("data-url")),e.hasAttribute("data-class")&&(this.modalClass=e.getAttribute("data-class")),e.hasAttribute("data-collapse")&&(this.collapse=e.getAttribute("data-collapse"))}this.loadContent()}show(t,e){this.url=t,e&&(this.modalClass=e),this.showModal()}loadContent(){i(),this.addLoadingClass(),this.addModalClass(),
this.getContent().load(this.url,(t,e)=>{this.onLoadContent(t,e)})}onLoadContent(t,e){"error"===e?this.hide():(this.removeLoadingClass(),this.addAnimateClass(),this.checkOverflowedHeight(),this.addCollapse())}addCollapse(){null!==this.collapse&&this.modal.setAttribute("data-collapse",this.collapse)}checkOverflowedHeight(){this.getContent().height()>window.innerHeight?this.modal.classList.add("overflowed"):this.restoreOverflowedHeight()}onHidden(){this.removeLastClass(),this.removeAnimateClass(),
this.getContent().empty(),this.restoreOverflowedHeight(),this.removeCollapse()}removeCollapse(){null!==this.collapse&&(this.modal.removeAttribute(this.collapse),this.collapse=null)}restoreOverflowedHeight(){this.modal.classList.remove("overflowed")}addLoadingClass(){this.modal.classList.add("loading")}removeLoadingClass(){this.modal.classList.remove("loading")}addModalClass(){this.modalClass!==this.lastClass&&(this.lastClass=this.modalClass),
this.lastClass&&this.lastClass.split(" ").forEach(t=>this.modal.classList.add(t))}addAnimateClass(){this.animateClass&&this.getAnimate().classList.add(this.animateClass)}removeAnimateClass(){this.lastClass&&this.getAnimate().classList.remove(this.animateClass)}getAnimate(){return this.modal.querySelector(".animate")}removeLastClass(){this.lastClass&&this.lastClass.split(" ").forEach(t=>this.modal.classList.remove(t))}getContent(){return this.$modal.find(".modal-content")}showModal(){
this.$modal.modal("show")}hide(){this.$modal.modal("hide")}lockHide(){this.modal.classList.add(s.CLASS_LOCKED_HIDE)}unlockHide(){this.modal.classList.remove(s.CLASS_LOCKED_HIDE)}onHide(t){return!this.modal.classList.contains(s.CLASS_LOCKED_HIDE)||(this.onLockedHide(t),!1)}onLockedHide(t){}setScroll(t){this.scroll=t}getScroll(){return this.scroll}}s.CLASS_LOCKED_HIDE="blocked-hide";let a=[];function n(t="#ajax-modal",e="zoom"){let i=function(t){return a.find(e=>e.selector===t)}(t)
;return i||((i=new s(t,e)).init(),a.push(i),i)}e.getAjaxModal=n,e.unlockAndHideAjaxModal=function(){i();let t=n();t.unlockHide(),t.hide()},e.loadAndShowModal=function(t,e=""){n().show(t,e)},e.showWindowAsPopup=function(t,e,i){var s=function(t,e){return{width:t,height:e,left:screen.width/2-t/2,top:screen.height/2-e/2}}(e,i);window.open(t,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,width="+s.width+",height="+s.height+",top="+s.top+",left="+s.left)},e.initLock=function(t,e){
t.onLockedHide=function(){swal({html:"If you quit now, some changes will not be saved.<br>Do you want to continue?",showCancelButton:!0,showCloseButton:!0,confirmButtonText:"Yes, quit"}).then(function(i){i.value&&(e.dispatchEvent(new Event("save.stop")),t.unlockHide(),t.hide())})},e.addEventListener("save.start",function(){t.lockHide()})}}(t.Popups||(t.Popups={}))}(Component||(Component={})),function(t){!function(t){t.ProgressBar=class{constructor(t){this.container=t,
this.bar=this.container.querySelector(".progress-bar")}active(){this.container.classList.add("active")}hide(){this.container.classList.remove("active")}set(t){t<0&&(t=0),t>100&&(t=100),this.bar.style.width=t+"%",this.bar.setAttribute("aria-valuenow",t.toString())}}}(t.ProgressBar||(t.ProgressBar={}))}(Component||(Component={})),function(t){!function(t){var e=Helpers.Dom.isOverflow,i=[];t.autoHideForList=function(t,e=".tags"){
for(var a,n=document.getElementById(t).querySelectorAll(e),r=0;a=n[r];r++){var o=new s(a);o.getOverflowedTags().length>1&&o.showOrHide(),i.push(o)}window.addEventListener("afterWidthChange",()=>{i.forEach(t=>{t.showOrHide()})})};class s{constructor(t,e=".tag"){this.tags=[],this.container=t,this.lastContainerWidth=this.width();for(var i,s=t.querySelectorAll(e),a=0;i=s[a];a++)this.tags.push(this.createTag(i))}createTag(t){return new a(t)}showOrHide(){
this.width()>this.lastContainerWidth?this.autoShow():this.autoHide(),this.lastContainerWidth=this.width()}autoHide(){let t=this.getOverflowedTags();t.length>1&&(t.pop().hide(),this.autoHide())}autoShow(){let t=this.getHiddenTags();for(;t.length;){let e=t.shift();this.width()-this.getTotalVisibleTagWidth()>e.width&&e.show()}}width(){return this.container.clientWidth}getTotalVisibleTagWidth(){let t=0;return this.tags.forEach(e=>{t+=e.element.clientWidth}),t}getOverflowedTags(){
return this.tags.filter(t=>t.isOverflow())}getHiddenTags(){return this.tags.filter(t=>t.isHidden())}}class a{constructor(t,e="hidden"){this.element=t,this.hiddenClass=e,this.width=t.clientWidth}isOverflow(){return e(this.element)}show(){this.element.classList.remove(this.hiddenClass)}hide(){this.element.classList.add(this.hiddenClass)}isHidden(){return this.element.classList.contains(this.hiddenClass)}}}(t.Tags||(t.Tags={}))}(Component||(Component={})),function(t){class e{constructor(){
this.items={}}add(t,e){this.items[t]=e}has(t){return t in this.items}get(t){return this.items[t]}toArray(){let t=[];for(let e in this.items)t.push(this.items[e]);return t}length(){return this.toArray().length}}t.Map=e;class i extends e{static createFromNodeList(t,e="id"){let s=new i;return t.forEach(t=>s.add(t.getAttribute(e),t)),s}static createFromSelector(t,e="id",i){return i?this.createFromNodeList(i.querySelectorAll(t),e):this.createFromNodeList(document.querySelectorAll(t),e)}}
t.HTMLElementsMap=i}(Data||(Data={})),function(t){!function(t){t.getBetween=function(t,e,i){let s=new RegExp("(?:"+e+")(.*?)(?:"+i+")","ig").exec(t);return s&&s.length?s[1]:""},t.isEmpty=function(t){return 0===t.length||!t.trim()},t.contains=function(t,e){return!!t.match(e)},t.textWidth=function(t,e){var i=$("<div></div>").text(t).css({position:"absolute",float:"left","white-space":"nowrap",visibility:"hidden",font:e}).appendTo($("body")),s=i.width();return i.remove(),s},
t.capitalizeFirstLetter=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},t.filterNumber=function(t,e=2){return function(t,e){return Number(t.replace(/[^0-9.]/g,"")).toFixed(e)}(function(t){return t.replace(/,/g,".")}(t),e)}}(t.String||(t.String={}))}(Helpers||(Helpers={})),function(t){var e=Helpers.String.filterNumber;class i{constructor(t,e){this.from=i.parseValue(t),this.to=i.parseValue(e)}static parseValue(t){return"string"==typeof t?parseFloat(e(t)):t}recalculateWithScale(t){
this.from<t.from&&(this.from=t.from),this.to>t.to&&(this.to=t.to),this.from>this.to&&(this.from=this.to)}compare(t){return this.from===t.from&&this.to===t.to?s.SAME:this.from>=t.from&&this.to<=t.to?s.BETWEEN:s.OVER}isBetween(t){return this.compare(t)===s.BETWEEN}isSame(t){return this.compare(t)===s.SAME}isOver(t){return this.compare(t)===s.OVER}}let s;t.RangeValues=i,function(t){t[t.SAME=0]="SAME",t[t.BETWEEN=1]="BETWEEN",t[t.OVER=-1]="OVER"}(s=t.RangeCompare||(t.RangeCompare={}))
}(Data||(Data={})),function(t){!function(t){var e=Helpers.Dom.setTitle;class i{constructor(t){this.btn=t,this.btn.hasAttribute("data-parent-wrapper")?this.titleWrapper=this.btn.parentElement:this.titleWrapper=this.btn,this.init()}init(){this.btn.addEventListener("click",t=>this.onClick(t)),this._isDisabled=this.btn.disabled||this.btn.classList.contains("disabled")}enabled(){this.btn.disabled=!1,this.btn.classList.remove("disabled"),this.btn.classList.add("active"),this._isDisabled=!1,
this.afterEnabled()}afterEnabled(){}isDisabled(){return this._isDisabled}disabled(){this.btn.disabled=!0,this.btn.classList.remove("active"),this.btn.classList.add("disabled"),this._isDisabled=!0,this.afterDisabled()}afterDisabled(){}onClick(t){this.isDisabled()&&t.stopPropagation()}setTitle(t){e(this.titleWrapper,t)}show(){this.btn.classList.remove("hide")}hide(){this.btn.classList.add("hide")}}t.ActiveButton=i;class s extends i{static createFromForm(t,e="[type=submit]"){
let i=t.querySelector(e);if(!i)throw console.log(t),"Not found submit button";return new s(i)}save(){this.btn.classList.add("save"),this.disabled(),this.setTitle("Saving...")}unsave(){this.btn.classList.remove("save"),this.enabled()}}t.ActiveSubmitButton=s;t.ActiveButtonTimeOut=class extends i{disabled(t){super.disabled(),t&&setTimeout(()=>this.enabled(),1e3*t)}enabled(t){super.enabled(),t&&setTimeout(()=>this.disabled(),1e3*t)}}}(t.Button||(t.Button={}))}(Widgets||(Widgets={})),function(t){
!function(t){var e=Widgets.Button.ActiveSubmitButton,i=Data.HTMLElementsMap,s=Helpers.String.isEmpty;let a;!function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FORM_FAIL_VALIDATION=1]="FORM_FAIL_VALIDATION"}(a=t.JSONCodeResponseType||(t.JSONCodeResponseType={}));class n{constructor(t,i=!0){if(this.activeSubmitBtns=[],this.form=document.getElementById(t),null===this.form)throw"Not found Form for id: "+t;this.$form=$(this.form),this.$inputs=this.$form.find(":input"),
i&&(this.form.querySelectorAll("[type=submit]").forEach(t=>{this.activeSubmitBtns.push(new e(t))}),this.activeSubmitBtn=e.createFromForm(this.form))}hasAllRequiredInputsNotEmpty(){return![...this.form.elements].some(t=>t.required&&s(t.value))}disableSubmitBtns(){this.activeSubmitBtns.forEach(t=>t.disabled())}enableSubmitBtns(){this.activeSubmitBtns.forEach(t=>t.enabled())}static errorsToString(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(t[i]);return e.join(" ")}serialize(){
return this.$form.serialize()}setSubmitBtnTitle(t){this.activeSubmitBtn.setTitle(t)}processFlashesFromResponse(t){t.__flashes&&Helpers.Dom.executeScript(t.__flashes)}}t.BaseForm=n,t.blockSubmitOnEnter=function(t){$(document).on("keypress",t,function(t){return 13!=t.keyCode})};let r={},o=[];t.createValidateAppendsForm=function(t){return r[t]||(r[t]=new l(t),-1===o.indexOf(t)&&(o.push(t),Component.Popups.getAjaxModal().$modal.on("hidden.bs.modal",()=>{delete r[t]}))),r[t]};class l extends n{
constructor(t,e=!0){super(t),this.errorAppendsMap={},this.afterValidateAttribute=((t,e,i,s)=>{s?(this.setErrorMsg(e.inputID,i[e.id]),this.disableSubmitBtns()):this.hasAllRequiredInputsNotEmpty()?this.enableSubmitBtns():this.disableSubmitBtns()}),jQuery(document).trigger("initTooltips"),e&&this.init(),this.errorsAppendsMap=new i}init(){this.$form.find(".has-error").each((t,e)=>{var i=$(e);this.setErrorMsg(i.find(".form-control").first().attr("id"),i.find(".help-block").text())})}setErrorMsg(t,e){
this.errorAppendsMap.hasOwnProperty(t)||(this.errorAppendsMap[t]=this.$form.find("#"+t).parent().find(".input-group-addon .error")),this.errorAppendsMap[t].attr("title",e)}}t.ValidateAppendsForm=l}(t.Form||(t.Form={}))}(Forms||(Forms={})),function(t){t.KeysUrlsBatchGenerator=class{constructor(t,e){this.url=t,this.keys=e}generate(t,e="ids"){let i=[];for(let s=0;s<this.keys.length;s+=t){let a=this.keys.slice(s,s+t),n=new URL(this.url);a.forEach(t=>{n.searchParams.append(e+"[]",t)}),i.push(n.href)}
return i}};t.SubmitBatch=class{constructor(t,e){this.doneUrls=[],this.queue=[],this.isStop=!1,this.urls=t,this.options=e||this.getDefaultOptions()}getDefaultOptions(){return{method:"POST",contentType:"application/x-www-form-urlencoded; charset=UTF-8"}}stop(){this.isStop=!0}send(t){this.initQueue(),this.queue.forEach((e,i)=>{i+1<this.queue.length&&(e.onload=(()=>{this.isStop||this.queue[i+1].send(t)})),0!==i||this.isStop||e.send(t)})}initQueue(){this.urls.forEach(t=>{let e=new XMLHttpRequest
;e.open(this.options.method,t),e.onreadystatechange=(()=>{4===e.readyState&&(this.doneUrls.push(t),this.onDone&&this.onDone(e,this.doneUrls,this.urls),this.doneUrls.length===this.urls.length&&this.onAllLoad&&this.onAllLoad(e))}),e.setRequestHeader("Content-Type",this.options.contentType),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),this.queue.push(e)})}}}(Forms||(Forms={})),function(t){!function(t){var e=Helpers.String.isEmpty,i=Helpers.Object.isUndefined;let s;!function(t){
t.clearOnChange="clear-on-change"}(s||(s={}));class a{constructor(t,e){if(this.isDropdown=!1,this.isToggleValue=!1,this.notClear=!1,this.isRegisterInitEvent=!1,this.attributeRelatedId="data-related-id",!(t instanceof HTMLElement))throw console.log(t),"filter must be instance of HtmlElement. filter: "+t;this.filter=t,this.id=t.getAttribute("id"),this.isDropdown=t.classList.contains("isDropdown"),this.isToggleValue=t.classList.contains("toggle-value-filter"),
this.notClear=t.classList.contains("not-clear"),this.options=e||{}}isFullPageRefresh(){return!1}setManager(t){this.manager=t}getManager(){return this.manager}init(){this.options&&this.parseOptions()}parseOptions(){this.options.initOnTrigger&&!this.isRegisterInitEvent&&(this.isRegisterInitEvent=!0,document.addEventListener("initFilters",()=>this.initOnTrigger()))}initOnTrigger(){setTimeout(()=>{this.init()},1e3)}isActive(){return this.filter.classList.contains("active")}active(){
this.isActive()||(this.isDropdown&&this.markDropdownAsActive(),this.filter.classList.add("active"),this.filter.dispatchEvent(new Event("active")))}markDropdownAsActive(){this.getDropdown().classList.add("active")}deactivate(){this.isDropdown&&this.unmarkDropdownAsActive(),this.filter.classList.remove("active"),this.filter.dispatchEvent(new Event("deactivate"))}unmarkDropdownAsActive(){this.getDropdown().classList.remove("active")}getDropdown(){
return this.dropdown||(this.dropdown=this.filter.closest(".filter-dropdown")),this.dropdown}clearRelatedOnChange(){return this.filter.hasAttribute("data-related-type")&&this.filter.getAttribute("data-related-type")===s.clearOnChange}clearRelated(){this.hasRelated()&&this.getRelated().forEach(t=>t.clear())}hasRelated(){return this.filter.hasAttribute(this.attributeRelatedId)}getRelated(){let t=[];if(this.hasRelated()){let e=this.getManager()
;this.filter.getAttribute(this.attributeRelatedId).split(",").forEach(function(i){let s=e.get(i);s&&t.push(s)})}return t}}t.BaseFilter=a;class n extends a{constructor(t,e){super(t,e),this.SELECTOR_CLEAR=".clear-input-action",this.withStatusParsing=!0,this.withUpdateLabelValue=!1,this._stringValue="",this.setOnlyNewValue=!0,this.input=this.findInput(),this.init()}findInput(){let t=this.filter.getElementsByTagName("input");if(0===t.length)throw"Input not found in filter :#"+this.filter.id
;return t[0]}isFullPageRefresh(){return this.input.hasAttribute("data-full-reload")}init(){super.init(),null!==this.filter.querySelector(this.SELECTOR_CLEAR)&&this.filter.querySelector(this.SELECTOR_CLEAR).addEventListener("click",()=>this.clear()),this.input.hasAttribute(n.ATTRIBUTE_UPDATE_LABEL_VALUE)&&(this.withUpdateLabelValue=!0),i(this._initValue)&&(this._initValue=this.getValue())}getLabel(){return this.input.getAttribute(n.ATTRIBUTE_LABEL)}parseOptions(){super.parseOptions(),
this.options.focusOnInit&&this.focusInput()}focusInput(){this.input.focus()}initOnTrigger(){super.initOnTrigger()}clear(){this.setStringValue(""),this.setValue("")}setStringValue(t){this._stringValue=t}getStringValue(){return this._stringValue}parseStringValue(){return this.getValue()}isEmpty(){return e(this.getValue())}onItemClick(t){}onChange(t){}getValue(){return this.input.value}setValue(t){if(this.setOnlyNewValue&&this.input.value===t)return;this.beforeSetValue(t),this.input.value=t
;let e=this.getSetterEvent();null!==e&&this.input.dispatchEvent(e),this.afterSetValue()}getSetterEvent(){return new CustomEvent("change")}beforeSetValue(t){}afterSetValue(){this.withStatusParsing&&this.parseStatus(),this.withUpdateLabelValue&&this.updateStringValue(),!this.isEmpty()&&this.clearRelatedOnChange()&&this.clearRelated(),this.setToggleValue()}updateStringValue(){this.setStringValue(this.parseStringValue())}parseStatus(){this.isEmpty()?this.deactivate():this.active()}setToggleValue(){
this.isToggleValue&&this.isDropdown&&(this.getDropdown().querySelector(".current .text .value").textContent=this.getStringValue())}}n.ATTRIBUTE_UPDATE_LABEL_VALUE="data-update-label-value",n.ATTRIBUTE_LABEL="data-label",t.OneInputFilter=n}(t.Filter||(t.Filter={}))}(Forms||(Forms={})),function(t){t.EmptyStatesSearchWidget=class{constructor(t){this.wrapper=t.querySelector(".empty-states"),this.searchPattern=this.wrapper.querySelector(".search-pattern")}show(t){this.setPattern(t),
this.wrapper.classList.contains("ajax-list-empty-states")||this.wrapper.classList.remove("hidden")}hide(){this.wrapper.classList.contains("ajax-list-empty-states")||this.wrapper.classList.add("hidden")}setPattern(t){this.searchPattern.textContent=t}}}(Widgets||(Widgets={})),function(t){!function(e){var i,s=t.String.filterNumber;function a(t,e=!0){clearTimeout(i);var a=t.hasAttribute("data-format-timeout")?parseFloat(t.getAttribute("data-format-timeout")):0;i=window.setTimeout(()=>{
if(t.hasAttribute("data-format-type")&&"number"===t.getAttribute("data-format-type")){var i="";if(!isNaN(parseFloat(t.value))){var a=parseInt(t.getAttribute("data-format-fractions"));i=s(t.value,parseInt(t.getAttribute("data-format-fractions")));var n=parseFloat(i);if(t.hasAttribute("data-min")){var r=parseFloat(t.getAttribute("data-min"));n<=r&&(i=r.toFixed(a))}if(t.hasAttribute("data-max")){var o=parseFloat(t.getAttribute("data-max"));n>=o&&(i=o.toFixed(a))}}
t.value!==i.toLocaleString()&&(t.value=i.toLocaleString(),t.dispatchEvent(new Event("change")),t.dispatchEvent(new Event("filter.change"))),e&&t.dispatchEvent(new Event("filter"))}},a)}e.inputTimeout=function(t,e=0){var i=parseFloat(t.getAttribute("data-update-timeout"));return i<0?e:i},e.copyPlaceholder=function(t,e="data-placeholder"){t.setAttribute(e,t.placeholder)},e.restorePlaceholder=function(t,e="data-placeholder"){t.placeholder=t.getAttribute(e)},e.inputClearOnFocus=function(t){
t.addEventListener("focus",function(){this.value=""})},e.inputRestoreValueOnFocusOut=function(t){t.addEventListener("focusout",function(){this.value="",""===this.value&&(t.value=t.placeholder)})},e.getFormatedValue=function(t){return t.hasAttribute("data-format")?function(t){if(t.hasAttribute("data-format-price")&&0===parseInt(t.value))return"Free";var e=t.getAttribute("data-format");return e?e.replace("{value}",t.value):t.value}(t):t.value},e.initFormat=function(t="change"){
document.querySelectorAll("input[data-format]").forEach(e=>{e.addEventListener(t,t=>a(t.currentTarget))})},e.filterValue=a,e.resizableInput=function(t){"keyup,keypress,focus,blur,change,resize".split(",").forEach(e=>{t.addEventListener(e,()=>r(t))}),r(t)};let n=null;function r(t){null===n&&((n=document.createElement("span")).classList.add("measure-input"),n=document.body.appendChild(n)),t.hasAttribute("data-measure-class")&&n.classList.add(t.getAttribute("data-measure-class")),
t.value.trim().length>0?n.textContent=t.value+"1":n.textContent=t.placeholder+"1",t.style.width=n.offsetWidth+"px",t.hasAttribute("data-measure-class")&&n.classList.remove(t.getAttribute("data-measure-class"))}e.intValue=function(t){let e=t.value.trim();return 0===e.length?0:parseInt(e)}}(t.Forms||(t.Forms={}))}(Helpers||(Helpers={})),function(t){!function(t){!function(e){var i=Widgets.EmptyStatesSearchWidget,s=Helpers.Forms.inputTimeout;class a extends t.OneInputFilter{constructor(){
super(...arguments),this.withStatusParsing=!1}getValue(){return super.getValue().toLowerCase().trim()}findInput(){let t=this.filter.querySelector("input[data-search-name]");if(!t)throw"input[data-search-name] not found in filter: #"+this.id;return t}init(){super.init(),this.input.addEventListener("keyup",t=>this.onKeyup(t)),this.input.addEventListener("focus",()=>this.onInputFocus()),this.input.addEventListener("focusout",()=>this.onInputFocusOut()),this.initValues(),
this._clear.addEventListener("click",()=>this.clearOnClick()),this.isEmpty()&&this.hideClear(),this.activeSearch()}clearOnClick(){this.clear(),this.hideClear(),this.showMore()}markInputAsNotEmpty(){this.inputWrapper.classList.add("active"),this.input.classList.add("not-empty")}markInputAsEmpty(){this.inputWrapper.classList.remove("active"),this.input.classList.remove("not-empty")}initOnTrigger(){this.filter=document.getElementById(this.id),this.input=this.findInput(),super.initOnTrigger()}
initValues(){this.searchAttribute||(this.searchAttribute="data-name"),this.list=this.filter.querySelector(".list"),this.more=this.filter.querySelector(".more"),this.inputWrapper=this.filter.querySelector(".search-bar-input"),this._clear=this.filter.querySelector(".clear-wrap"),this.limit=parseInt(this.list.getAttribute("data-limit")),this.items=this.list.querySelectorAll(".item"),this.updateItems(),this.emptyStates=new i(this.filter)}updateItems(){
this.items=this.list.querySelectorAll(".item["+this.searchAttribute+"]")}hideClear(){this.hideElement(this._clear)}showClear(){this.showElement(this._clear)}onInputFocus(){this.hideMore(),this.showClear()}onInputFocusOut(){this.isEmpty()&&(this.showMore(),this.hideClear(),this.markInputAsEmpty())}showMore(){this.more&&this.showElement(this.more)}hideMore(){this.more&&this.hideElement(this.more)}onKeyup(t){clearTimeout(a.timeoutFilterSearch),
a.timeoutFilterSearch=window.setTimeout(()=>this.activeSearch(),s(t.currentTarget,500))}activeSearch(){this.pattern=this.getValue(),this.pattern.length>0?(this.markInputAsNotEmpty(),this.filterList()):(this.markInputAsEmpty(),this.clear())}filterList(){var t=this.showPatternItems(this.pattern);0===t?this.showEmptyStates():this.hideEmptyStates(),this.initMore(t)}initMore(t){t>=0?this.hideMore():this.showMore()}showEmptyStates(){this.emptyStates.show(this.pattern),this.hideElement(this.list)}
hideEmptyStates(){this.showElement(this.list),this.emptyStates.hide()}showPatternItems(t){var e=0;return this.items.forEach(i=>{var s=i.getAttribute(this.searchAttribute).toLowerCase();i.classList.remove("first"),-1!==s.indexOf(t)?(this.showElement(i),1===++e&&i.classList.add("first")):this.hideElement(i)}),e}clear(){super.clear(),this.showAllItems(),this.hideEmptyStates(),this.markInputAsEmpty()}showAllItems(){this.items.forEach(t=>{this.showElement(t),t.classList.remove("first")})}
showElement(t){t.classList.contains("ajax-items-list")||t.classList.remove("hidden")}hideElement(t){t.classList.contains("ajax-items-list")||t.classList.add("hidden")}}e.ListSearch=a;let n=[];e.get=function(t){return n.find(e=>e.filter===t)},e.create=function(t,e){n.push(new a(t,e))}}(t.ListSearch||(t.ListSearch={}))}(t.Filter||(t.Filter={}))}(Forms||(Forms={})),function(t){!function(e){var i=Helpers.String.isEmpty,s=t.Filter.ListSearch.get;class a{constructor(t){if(this.values={},this._count=0,
!i(t)){var e=t.split(",");for(var s in e)this.add(e[s])}}count(){return this._count}add(t){this.values[t]=t,this._count++}remove(t){this.values.hasOwnProperty(t)&&(delete this.values[t],this._count--)}clear(){this.values={},this._count=0}getFilterString(){var t=[];for(var e in this.values)this.values.hasOwnProperty(e)&&t.push(Number(this.values[e]));return t.sort(function(t,e){return t-e}).join(",")}getValues(){return this.values}}class n extends e.OneInputFilter{constructor(t,e){super(t,e),
this.allStringText="all",this.emptyStringText="none",this.limitStringText=1,this.activeEditItem=null,this.setDefaultStringValues(),this.listSearch=s(this.filter)}setDefaultStringValues(){this.input.hasAttribute("data-all-text")&&(this.allStringText=this.input.getAttribute("data-all-text")),this.input.hasAttribute("data-empty-text")&&(this.emptyStringText=this.input.getAttribute("data-empty-text")),
this.input.hasAttribute("data-limit-text")&&(this.limitStringText=parseInt(this.input.getAttribute("data-limit-text")))}init(){if(super.init(),this.loadItems(),this.items.forEach(t=>this.registerItemEvents(t)),this._turnAllOff=this.filter.querySelector(n.SELECTOR_TURN_ALL_OFF),this._turnAllOff&&(this._turnAllOff.onclick=(t=>this.turnAllOff(t))),this._turnAllOn=this.filter.querySelector(n.SELECTOR_TURN_ALL_ON),this._turnAllOn&&(this._turnAllOn.onclick=(t=>this.turnAllOn(t))),
this._turnAllColumnOff=this.filter.querySelectorAll(n.SELECTOR_TURN_ALL_OFF_COLUMN),this._turnAllColumnOff)for(let t=0;this._turnAllColumnOff[t];t++)this._turnAllColumnOff[t].onclick=(e=>this.turnAllColumnOff(e,this._turnAllColumnOff[t].getAttribute("data-column")));if(this._turnAllColumnOn=this.filter.querySelectorAll(n.SELECTOR_TURN_ALL_ON_COLUMN),
this._turnAllColumnOn)for(let t=0;this._turnAllColumnOn[t];t++)this._turnAllColumnOn[t].onclick=(e=>this.turnAllColumnOn(e,this._turnAllColumnOn[t].getAttribute("data-column")))}loadItems(){this.items=this.findItems(),this.hasEditItemsInList=[...this.items].some(t=>t.classList.contains(n.CLASS_EDIT_ITEM)),this.listSearch&&this.listSearch.updateItems()}findItems(){return this.filter.querySelectorAll(n.SELECTOR_ITEM)}registerItemEvents(t){
t.addEventListener("click",t=>this.onItemClick(t,"include")),t.addEventListener("switch",t=>this.toggle(t.currentTarget)),t.classList.contains("removable-item")&&t.querySelector(".swal-confirm").addEventListener("swalActionSuccess",()=>{this.removeItem(t)}),t.classList.contains("item-with-exclude")&&t.querySelector(".filter-checkbox-exclude").addEventListener("click",t=>this.onItemClick(t,"exclude"))}getItemsLength(){return this.items.length}getItemsNames(){
return[...this.items].map(t=>this.getName(t))}addItem(e,i,s=!1,a=!0){let n=this.items.item(i);n&&(n.parentNode.insertBefore(e,a?n.nextSibling:n),this.registerItemEvents(e),s&&t.Filter.CheckboxesListFilter.triggerSwitch(e),this.loadItems())}removeItem(t){this.isActiveItem(t)&&this.toggle(t),t.classList.add("removing"),setTimeout(()=>{t.remove(),this.loadItems()},800)}onItemClick(t,e){let i=t.currentTarget;if("exclude"===e&&(t.preventDefault(),t.stopImmediatePropagation(),
i=t.target.parentElement),this.hasEditItemsInList){let e=this.hasActiveEditItem(),s=t.target;(i!==this.activeEditItem||s.classList.contains(n.CLASS_EDIT_INPUT_WRAPPER))&&this.unmarkActiveEditItem(),this.isEditActivate(s)&&this.markItemAsActiveEdit(i),e||this.activeEditItem===i||this.toggle(i)}else"exclude"===e?this.toggleExclude(i):this.toggle(i);this.afterItemClick(t)}isEditActivate(t){return t.classList.contains(n.CLASS_EDIT_ACTIVATE)}hasActiveEditItem(){return null!==this.activeEditItem}
markItemAsActiveEdit(t){this.activeEditItem=t,this.activeEditItem.dispatchEvent(new Event("active-edit")),this.activeEditItem.classList.add("active-edit"),this.afterMarkItemAsEdit(t)}afterMarkItemAsEdit(t){}unmarkActiveEditItem(){this.activeEditItem&&this.activeEditItem.classList.remove("active-edit"),this.activeEditItem=null}toggle(t){this.isActiveItem(t)?this.deactivateItem(t):(this.deactivateExcludedItem(t),this.activateItem(t)),clearTimeout(this.setValueTimeout),
this.setValueTimeout=window.setTimeout(()=>{this.setValue(this.arrayValues.getFilterString())},500)}toggleExclude(t){this.isActiveExcludeItem(t)?this.deactivateExcludedItem(t):(this.deactivateItem(t),this.activateExcludeItem(t)),clearTimeout(this.setValueTimeout),this.setValueTimeout=window.setTimeout(()=>{this.setValue(this.arrayValues.getFilterString())},500)}deactivateItem(t){t.classList.remove("active"),this.removeItemKey(t)}deactivateExcludedItem(t){t.classList.remove("active-exclude"),
this.removeExcludedItemKey(t)}removeItemKey(t){this.getArrayValues().remove(this.getKey(t))}removeExcludedItemKey(t){this.getArrayValues().remove("-"+this.getKey(t))}activateItem(t){t.classList.add("active"),this.addItemKey(t)}activateExcludeItem(t){t.classList.add("active-exclude"),this.addExcludeItemKey(t)}addItemKey(t){null!==this.getKey(t)&&this.getArrayValues().add(this.getKey(t))}addExcludeItemKey(t){this.getArrayValues().add("-"+this.getKey(t))}getKey(t){
return t.getAttribute(n.ATTRIBUTE_KEY)}findItem(t){return[...this.items].find(e=>this.getKey(e)===t)}afterItemClick(t){}setValueAsAll(){this.items.forEach(t=>this.addItemKey(t)),this.setValue(this.getArrayValues().getFilterString())}setValueAsColumnAll(t){this.getColumnItems(t).forEach(t=>this.addItemKey(t)),this.setValue(this.getArrayValues().getFilterString())}clearColumn(t){this.getActiveColumnItems(t).forEach(t=>this.deactivateItem(t)),
this.getActiveColumnItems(t).forEach(t=>this.deactivateExcludedItem(t))}clear(){super.clear(),this.getActiveItems().forEach(t=>this.deactivateItem(t)),this.getActiveItems().forEach(t=>this.deactivateExcludedItem(t)),this.getArrayValues().clear()}static triggerSwitch(t){t.dispatchEvent(new Event("switch"))}getActiveItems(){return[...this.items].filter(t=>this.isActiveItem(t))}getNotActiveItems(){return[...this.items].filter(t=>!this.isActiveItem(t))}getColumnItems(t){
return[...this.items].filter(e=>e.classList.contains("item-column-"+t))}getActiveColumnItems(t){return[...this.items].filter(e=>this.isActiveItem(e)&&e.classList.contains("item-column-"+t))}getNotActiveColumnItems(t){return console.log([...this.items].filter),[...this.items].filter(e=>!this.isActiveItem(e)&&e.classList.contains("item-column-"+t))}isActiveItem(t){return t.classList.contains("active")}isActiveExcludeItem(t){return t.classList.contains("active-exclude")}turnAllOn(t){
t.preventDefault(),this.getNotActiveItems().forEach(t=>this.toggle(t)),this._turnAllOn.classList.add("disabled"),this._turnAllOff.classList.remove("disabled"),this.setValueAsAll()}turnAllOff(t){t.preventDefault(),this.getActiveItems().forEach(t=>this.toggle(t)),this._turnAllOff.classList.add("disabled"),this._turnAllOn.classList.remove("disabled"),this.clear()}turnAllColumnOn(t,e){t.preventDefault(),this.getNotActiveColumnItems(e).forEach(t=>this.toggle(t))
;for(let t=0;this._turnAllColumnOff[t];t++)this._turnAllColumnOff[t].getAttribute("data-column")===e&&this._turnAllColumnOff[t].classList.remove("disabled");for(let t=0;this._turnAllColumnOn[t];t++)this._turnAllColumnOn[t].getAttribute("data-column")===e&&this._turnAllColumnOn[t].classList.add("disabled");this.setValueAsColumnAll(e)}turnAllColumnOff(t,e){t.preventDefault(),this.getActiveColumnItems(e).forEach(t=>this.toggle(t))
;for(let t=0;this._turnAllColumnOff[t];t++)this._turnAllColumnOff[t].getAttribute("data-column")===e&&this._turnAllColumnOff[t].classList.add("disabled");for(let t=0;this._turnAllColumnOn[t];t++)this._turnAllColumnOn[t].getAttribute("data-column")===e&&this._turnAllColumnOn[t].classList.remove("disabled");this.clearColumn(e)}selectItems(t){this.clear(),this.input.value=t}getItem(t){return[...this.items].find(e=>e.getAttribute(n.ATTRIBUTE_KEY)===t)}getName(t){
return t.getAttribute(n.ATTRIBUTE_NAME)}parseStringValue(){var t=this.getArrayValues().count();if(t===this.items.length&&t>this.limitStringText)return this.allStringText;if(0===t)return this.emptyStringText;let e=[];this.getActiveItems().every(t=>e.length<this.limitStringText&&(e.push(this.getName(t)),!0));let i=e.join(", "),s=t-e.length;return s>0&&(i+=" + "+s),i}getArrayValues(){return this.arrayValues instanceof a||(this.arrayValues=new a(this.getValue())),this.arrayValues}}
n.SELECTOR_ITEM=".filter-switch",n.SELECTOR_TURN_ALL_OFF=".turn-all-off",n.SELECTOR_TURN_ALL_ON=".turn-all-on",n.SELECTOR_TURN_ALL_OFF_COLUMN=".turn-all-off-column",n.SELECTOR_TURN_ALL_ON_COLUMN=".turn-all-on-column",n.CLASS_EDIT_ITEM="editable-item",n.CLASS_EDIT_ACTIVATE="edit-activate",n.CLASS_EDIT_INPUT_WRAPPER="item-input-wrapper",n.CLASS_ACTIVE_EXCLUDE="active-exclude",n.ATTRIBUTE_KEY="data-id",n.ATTRIBUTE_NAME="data-name",e.CheckboxesListFilter=n;class r{static getItemCounter(t){
return r.getMatch(t)[0]}static getTotalItemCounter(t){return r.getMatch(t)[1]}static switchCounter(t,e){return e?t.replace(r.getItemCounter(t),r.getTotalItemCounter(t)):t.replace(r.getItemCounter(t),"0")}static generateCounterText(t,e){return"( "+t+" / "+e+" )"}static getMatch(t){return t.match(r.rx)}}r.rx=/\d+/g,e.ItemCounter=r;class o extends n{constructor(t,e){super(t,e),this.isStringSummary=!1,e.changesInputSelector&&(this.changesInput=this.filter.querySelector(e.changesInputSelector),
this.variousArrayValues=new a("")),this.filter.hasAttribute(o.SUMMARY_STRING_ATTRIBUTE)&&(this.isStringSummary=!0,this.setStringValue(this.parseStringValue()),this.updateSummary())}afterSetValue(){super.afterSetValue(),this.updateSummary()}updateSummary(){this.getSummary().textContent=this.getSummaryText()}getSummary(){return this.options.summary}getSummaryText(){if(this.hasMiddleSwitch())return"various";let t=this.items.length,e=this.getActiveLength()
;return e===t?"all":0===e?"none":this.isStringSummary?this.getStringValue():r.generateCounterText(e,t)}toggle(t){super.toggle(t),this.hasChangesInput()&&(o.isMiddleItem(t)&&t.classList.remove(o.MIDDLE_CLASS),this.isActiveItem(t)?this.addVariousData(t):this.removeVariousData(t),void 0!==this.variousArrayValues&&this.variousArrayValues.remove(null),this.changesInput&&(this.changesInput.value=this.variousArrayValues.getFilterString())),o.updateItemCounter(t)}addVariousData(t){
if(this.variousArrayValues){let e=this.getKey(t);this.variousArrayValues.add(e),this.variousArrayValues.remove("-"+e)}}removeVariousData(t){if(this.variousArrayValues){let e=this.getKey(t);this.variousArrayValues.add("-"+e),this.variousArrayValues.remove(e)}}selectItems(t,e=!1){super.selectItems(t);let i=t.split(",");this.items.forEach(t=>{-1!==i.indexOf(this.getKey(t))&&t.classList.add("active"),e&&o.updateItemCounter(t)})}static updateItemCounter(t){let e=t.querySelector(o.COUNTER_SELECTOR)
;e&&(isNaN(Number(e.getAttribute(this.COUNTER_BASE_ATTRIBUTE)))&&e.setAttribute(this.COUNTER_SELECTOR,r.getItemCounter(e.textContent)),e.textContent=r.switchCounter(e.textContent,t.classList.contains("active")))}getActiveLength(){return[...this.items].filter(t=>this.isActiveCounterItem(t)).length}isActiveCounterItem(t){if(this.isActiveItem(t))return!0;{let e=t.querySelector(".item-count");if(e&&parseInt(r.getItemCounter(e.textContent))>0)return!0}return!1}hasMiddleSwitch(){
return[...this.items].some(t=>o.isMiddleItem(t))}static isMiddleItem(t){return t.classList.contains(o.MIDDLE_CLASS)}isEmpty(){return 0===this.getActiveLength()}hasChangesInput(){return null!==this.changesInput}parseStatus(){setTimeout(()=>super.parseStatus(),200)}}o.MIDDLE_CLASS="middle",o.COUNTER_SELECTOR=".item-count",o.COUNTER_BASE_ATTRIBUTE="data-base-item-count",o.SUMMARY_STRING_ATTRIBUTE="data-summary-string",e.CheckboxesListCounterFilter=o}(t.Filter||(t.Filter={}))}(Forms||(Forms={})),
function(t){!function(t){var e=Helpers.Object.isUndefined;t.SingleFilter=class extends t.OneInputFilter{constructor(t,e){super(t,e),this.disabledValue="",this.enabledValue="1",this.withInputDisable=!1,this.switch=this.findSwitch(),this.setDefaultValues()}findSwitch(){return this.filter.querySelector(this.getSwitchSelector())}getSwitchSelector(){return"[data-filter]"}setDefaultValues(){this.setDisabledDataValue(),this.setEnabledDataValue()}setEnabledDataValue(){if(this.switch){
var t=this.switch.getAttribute("data-enabled");e(t)||t===this.enabledValue||(this.enabledValue=t)}}setDisabledDataValue(){if(this.switch){var t=this.switch.getAttribute("data-disabled");e(t)||t===this.disabledValue||(this.disabledValue=t)}}init(){super.init(),this.filter.addEventListener("click",t=>this.onItemClick(t)),this.input.addEventListener("change",t=>this.onChange(t))}onItemClick(t){this.changeState(),this.afterItemClick(t)}afterItemClick(t){}changeState(){
this.isActive()?this.disable():this.enable()}enable(){this.withInputDisable&&(this.input.disabled=!1),this.active(),this.setValue(this.enabledValue)}disable(){this.withInputDisable&&(this.input.disabled=!0),this.deactivate(),this.setValue(this.disabledValue)}active(){super.active(),this.switch&&this.switch.classList.add("active")}deactivate(){super.deactivate(),this.switch&&this.switch.classList.remove("active")}clear(){this.setStringValue(""),""===this.disabledValue?this.disable():this.enable()
}isEmpty(){return this.getValue()==this.disabledValue}};t.SingleGroupFilter=class{constructor(t){this.filters=t,this.init()}init(){this.filters.forEach(t=>{t.filter.addEventListener("active",()=>this.onFilterActive(t))})}onFilterActive(t){this.filtersWithout(t).forEach(t=>{t.disable()})}filtersWithout(t){return this.filters.filter(e=>e.id!==t.id)}}}(t.Filter||(t.Filter={}))}(Forms||(Forms={})),function(t){!function(t){var e=Helpers.String.isEmpty,i=Data.HTMLElementsMap
;class s extends t.OneInputFilter{getActiveItem(){return this.activeItem}init(){super.init(),this.input.addEventListener("change",t=>this.onChange(t)),this.items=this.findItems(),this.items.toArray().forEach(t=>{t.addEventListener("click",t=>this.onItemClick(t))}),this.activeItem=this.findActiveItem(),this.isToggleValue&&this.filter.classList.contains("auto-set-value")&&this.activeItem&&(this.updateActiveStringValue(),this.setToggleValue())}findItems(){
return i.createFromSelector(this.getItemSelector(),s.ATTRIBUTE_VALUE,this.filter)}getItemSelector(){return".filter-radio-item"}getItemsArray(){return this.items.toArray()}updateActiveStringValue(){let t="";this.activeItem&&(t=this.getTextValue(this.activeItem)),this.setStringValue(t)}getRadioSelector(){return this.getItemSelector()}beforeItemClick(t){}onItemClick(t){this.beforeItemClick(t),this.selectItem(s.getValueFromItem(t.currentTarget)),
""===s.getValueFromItem(t.currentTarget)&&jQuery(t.currentTarget).closest(".filter-dropdown").find(".current").first().find(".text .value").text(t.currentTarget.textContent),this.afterItemClick(t)}afterItemClick(t){}static getValueFromItem(t){return t.getAttribute(s.ATTRIBUTE_VALUE)}getItem(t){if(this.items.has(t))return this.items.get(t);throw"Not found radio item for value: "+t}selectItem(t){let e=this.getItem(t);e!==this.activeItem&&(this.clear(),this.markAsActive(e),
this.setStringValue(this.getTextValue(e)),this.setValue(t))}getTextValue(t){let e=this.findTextValue(t);return e?e.textContent:""}findTextValue(t){return t.querySelector(".link")}markAsActive(t){this.activeItem=t,t.classList.add("active"),t.parentElement.classList.add("active")}clear(){super.clear(),this.unmarkActiveItem()}unmarkActiveItem(){this.activeItem&&this.unmarkAsActive(this.activeItem),this.activeItem=void 0}unmarkAsActive(t){t.classList.remove("active"),
t.parentElement.classList.remove("active")}findActiveItem(){return this.items.toArray().find(t=>t.classList.contains("active"))}}s.ATTRIBUTE_VALUE="data-value",t.RadioFilter=s;class a extends s{beforeSetValue(t){let e=a.getViewClass(this.getValue()),i=a.getViewClass(t);""!==e&&document.body.classList.remove(e),""!==i&&document.body.classList.add(i)}static getViewClass(t){return e(t)?"":"view-"+t}}t.ViewRadioFilter=a;t.PageSizeRadioFilter=class extends s{};class n extends s{constructor(){
super(...arguments),this.withStatusParsing=!1}init(){super.init(),[...this.filter.querySelectorAll(this.getItemSelector())].forEach(t=>{t.addEventListener("click",t=>this.onLabelClick(t))}),this.setStringValue(this.parseStringValue())}onLabelClick(t){let e=this.findItemToSelect(t.currentTarget);this.selectItem(n.getValueFromItem(e))}findItemToSelect(t){return null!==t.parentElement.querySelector(".direction:not(.active)")?t.parentElement.querySelector(".direction:not(.active)"):t}
getItemSelector(){return".sort-item .direction"}parseStringValue(){return this.getActiveItem().getAttribute("data-name")}afterSetValue(){super.afterSetValue(),t.FilterDropdown.closeOpenFilterDropdown()}}t.SortRadioFilter=n}(t.Filter||(t.Filter={}))}(Forms||(Forms={})),function(t){!function(e){
var i,s=t.Form.BaseForm,a=t.Filter.ItemCounter,n=t.Form.blockSubmitOnEnter,r=t.Filter.SingleFilter,o=t.Filter.SingleGroupFilter,l=t.Filter.CheckboxesListCounterFilter,c=t.Filter.RadioFilter,h=Helpers.Forms.getFormatedValue,d=Helpers.Object.isEmpty,u=t.Form.JSONCodeResponseType,m=Component.Alert.sweetAlert,p=Component.ProgressBar.ProgressBar;class f extends s{constructor(t,e){super(t),this.gamesIds=[],n("#"+t),this.target=new v(this),this.isMultiple=e.isMultiple,this.isCreateForm=e.isNewRecord,
e.gamesIds&&(this.gamesIds=e.gamesIds),e.submitBatchLimit&&(this.submitBatchLimit=e.submitBatchLimit),this.onSuccessSave=e.onSuccessSave,this.progressBar=new p(this.form.querySelector(".progress")),this.submitBatchLimit=e.submitBatchLimit,this.hasCounters=this.isMultiple&&!this.isCreateForm,this.notificationsMethods=new A(this.form.querySelector(".notifications-collapse"),e.notificationsText,this.hasCounters)}init(){jQuery(document).trigger("initTooltips"),
this.createAndInitCheckboxesList(this.form.getElementsByClassName("shops-collapse")[0],!1),this.createAndInitCheckboxesList(this.form.getElementsByClassName("drm-collapse")[0],!1),this.createAndInitCheckboxesList(this.form.getElementsByClassName("news-collapse")[0],!0),this.target.init(),this.initActiveSubmitBtn(),this.form.onsubmit=(t=>this.onSubmit(t)),this.form.addEventListener("save.stop",()=>this.stopSave())}createAndInitCheckboxesList(t,e){let i={
summary:t.querySelector("a.form-control .value"),allowEmpty:e};this.hasCounters&&(i.changesInputSelector=".changes-input");let s=new l(t.getElementsByClassName("filter")[0],i);return s.getActiveLength()>0?t.classList.add("active"):t.classList.remove("active"),s.filter.addEventListener("deactivate",()=>{t.classList.remove("active")}),s.input.addEventListener("change",()=>{setTimeout(()=>{s.isActive()&&t.classList.add("active")},500)}),s}initActiveSubmitBtn(){
this.activeSubmitBtn.afterEnabled=(()=>{this.setSubmitBtnTitle("")})}onSubmit(t){t.preventDefault(),t.stopImmediatePropagation(),this.form.dispatchEvent(new Event("save.start")),this.form.classList.add("sending"),this.activeSubmitBtn.save(),this.progressBar.active(),this.progressBar.set(0),this.isMultiple&&this.gamesIds.length>=this.submitBatchLimit?this.batchSubmit():this.singleSubmit()}singleSubmit(){this.progressBar.set(50),$.ajax(this.form.action,{type:"POST",data:this.serialize(),
dataType:"json",success:t=>{this.progressBar.set(100),this.onSuccess(t)},error:()=>this.onError()})}batchSubmit(){this.submitBatch=this.createSubmitBatch(),this.submitBatch.send(this.serialize())}createSubmitBatch(){var e=this.form.action.split("?")[0],i=new t.KeysUrlsBatchGenerator(e,this.gamesIds).generate(this.submitBatchLimit),s=new t.SubmitBatch(i);return s.onDone=((t,e,i)=>{this.progressBar.set(e.length/i.length*100)}),s.onAllLoad=(t=>{if(200!==t.status)this.onError();else{
JSON.parse(t.response);this.onSuccess(JSON.parse(t.response))}}),s}onSuccess(t){t.code===u.FORM_FAIL_VALIDATION&&this.onError(f.errorsToString(t.errors)),t.code===u.SUCCESS&&this.onSuccessSave(),this.processFlashesFromResponse(t)}onError(t){this.activeSubmitBtn.unsave(),this.progressBar.set(0),this.progressBar.hide(),t?m(t):m()}stopSave(){this.submitBatch&&this.submitBatch.stop()}}e.Form=f;class g extends c{init(){super.init(),Helpers.Forms.initFormat("keyup"),
this.counters=[...this.filter.querySelectorAll(".summary")]}hasCounters(){return this.counters.length>0}onItemClick(t){super.onItemClick(t);var e=t.currentTarget.getElementsByTagName("input");e.length&&e[0].focus()}afterItemClick(t){super.afterItemClick(t),this.hasCounters()&&(this.clearAllCounter(),this.updateItemCounter(t.currentTarget))}clearAllCounter(){this.counters.forEach(t=>t.textContent=a.switchCounter(t.textContent,!1))}updateItemCounter(t){var e=t.getElementsByClassName("summary")[0]
;e.textContent=a.switchCounter(e.textContent,!0)}getTextValue(t){var e=t.getElementsByTagName("input");return e.length?h(e[0]):t.querySelector(".title").textContent}}class v{constructor(t){this.form=t,this.container=this.form.form.getElementsByClassName("alert-target-collapse")[0],this.targetValue=this.container.querySelector("a[data-toggle] .value"),this.targets=new g(document.getElementById("alert-target-filter")),this.priceInput=this.container.querySelector(".price-input-widget input")}
init(){this.registerEvents(),"price"!==this.targets.getValue()&&(this.priceInput.value="")}registerEvents(){this.targets.onChange=(()=>this.onTargetsChange()),this.targets.getItemsArray().forEach(t=>{let e=t.getElementsByTagName("input");e.length&&e[0].addEventListener("filter",t=>this.onInputFilter(t))})}onTargetsChange(){this.form.activeSubmitBtn.disabled(),this.setTargetValue(this.targets.getStringValue()),this.activate()}onInputFilter(t){this.updateFilterTextValue(t.currentTarget),
this.activate()}updateFilterTextValue(t){setTimeout(()=>{this.targets.updateActiveStringValue(),this.setTargetValue(this.targets.getStringValue()),t.dispatchEvent(new Event("change"))},200)}setTargetValue(t){this.targetValue.textContent=t}activate(){this.hasTargetPrice()?this.container.classList.add("active"):this.container.classList.remove("active")}hasTargetPrice(){return 0===this.targets.getActiveItem().querySelectorAll(".has-error").length}}class A{constructor(t,e,i){this.filters=[],
this.container=t,this.notificationsMethodsText=e,this.hasCounter=i,this.notificationText=this.container.querySelector("a.form-control .value"),this.init()}createFilters(){let t=this.container.querySelectorAll(".alert-methods .filter");for(var e=0;e<t.length;e++)this.filters.push(this.createFilter(t[e]))}createFilter(t){let e=new r(t);return e.withStatusParsing=!1,e}getEmailFilter(){return this.filters.filter(t=>t.filter.classList.contains("email-notifications"))}init(){this.createFilters(),
new o(this.getEmailFilter()),this.changeMethodBtnText(),this.registerFilterEvents()}registerFilterEvents(){this.filters.forEach(t=>{if(t.afterItemClick=(()=>this.changeMethodBtnText()),this.hasCounter){let e=t.filter.querySelector(".subtitle");t.filter.addEventListener("active",()=>{e.textContent=a.switchCounter(e.textContent,!0)}),t.filter.addEventListener("deactivate",()=>{e.textContent=a.switchCounter(e.textContent,!1)})}})}changeMethodBtnText(){
this.notificationText.innerText=this.getChangeMethodText()}getChangeMethodText(){if(!this.notificationText.innerText.length&&this.hasCounter)return this.notificationsMethodsText.noChanges;let t=[];return this.filters.forEach(e=>{if(e.isActive()){let i=e.getLabel();t.length&&(i=i.toLowerCase()),t.push(i)}}),t.length>0?t.join(" & "):this.notificationsMethodsText.withoutMethod}}e.afterValidateAttribute=function(t,e,a,n){i.target.activate(),
d(a)?i.target.hasTargetPrice()?i.activeSubmitBtn.enabled():(i.setSubmitBtnTitle("Target cannot be blank."),i.activeSubmitBtn.disabled()):(i.setSubmitBtnTitle(s.errorsToString(a)),i.activeSubmitBtn.disabled())},e.create=function(t,e){(i=new f(t,e)).init()}}(t.Alert||(t.Alert={}))}(Forms||(Forms={})),function(t){!function(t){t.timeCutter=function(t){return{days:Math.floor(t/864e5),hours:Math.floor(t%864e5/36e5),minutes:Math.floor(t%36e5/6e4),seconds:Math.floor(t%6e4/1e3)}},
t.durationFormatter=function(t){let e=Math.floor(t/60);t%=60;let i="";return e>0&&(i+=e+"h",t>0&&(i+=" ")),t>0&&(i+=t+"m"),i}}(t.Time||(t.Time={}))}(Helpers||(Helpers={})),function(t){!function(e){
var i,s=t.Form.BaseForm,a=t.Form.blockSubmitOnEnter,n=t.Filter.CheckboxesListCounterFilter,r=Helpers.Object.isEmpty,o=Helpers.Forms.resizableInput,l=t.Form.JSONCodeResponseType,c=Component.Alert.sweetAlert,h=Helpers.Dom.createElementFromHTML,d=Component.ProgressBar.ProgressBar,u=Widgets.Button.ActiveSubmitButton,m=t.Filter.BaseFilter,p=Helpers.Time.durationFormatter,f=Helpers.Forms.intValue;class g extends m{constructor(t){super(t),this.hours=this.filter.querySelector(".hours-input"),
this.minutes=this.filter.querySelector(".minutes-input"),this.otherPlatformMinutes=parseInt(this.filter.getAttribute("data-platforms-minutes")),this.emptyText=this.filter.getAttribute("data-empty-text"),this.init()}init(){super.init(),Helpers.Forms.initFormat("keyup"),this.hours.addEventListener("filter",()=>{this.activateProcess()}),this.minutes.addEventListener("filter",()=>{this.activateProcess()})}activateProcess(){this.getMinutesValue()>0?this.active():this.deactivate(),
this.filter.dispatchEvent(new Event("change"))}clear(){this.minutes.value="",this.hours.value=""}getMinutesValue(){return 60*f(this.hours)+f(this.minutes)}getTotalMinutes(){return this.otherPlatformMinutes+this.getMinutesValue()}format(){let t=this.getTotalMinutes();return t>0?p(t):this.emptyText}}class v extends s{constructor(t,e){if(super(t),this.gamesIds=[],a("#"+t),this.isMultiple=e.isMultiple,this.isCreateForm=e.isNewRecord,e.gamesIds&&(this.gamesIds=e.gamesIds),
e.submitBatchLimit&&(this.submitBatchLimit=e.submitBatchLimit),this.onSuccessSave=e.onSuccessSave,this.progressBar=new d(this.form.querySelector(".progress")),this.submitBatchLimit=e.submitBatchLimit,this.hasCounters=this.isMultiple&&!this.isCreateForm,!this.isMultiple){let t=this.form.querySelector("#time-collapse");this.playedTimeFilter=new g(t.querySelector(".played-time-item"));let e=t.querySelector("a.form-control .value");this.playedTimeFilter.filter.addEventListener("deactivate",()=>{
0===this.playedTimeFilter.otherPlatformMinutes&&t.classList.remove("active")}),this.playedTimeFilter.filter.addEventListener("active",()=>{this.playedTimeFilter.getTotalMinutes()>0&&t.classList.add("active")}),this.playedTimeFilter.filter.addEventListener("change",()=>{e.textContent=this.playedTimeFilter.format()})}}init(){this.createAndInitCheckboxesList(this.form.getElementsByClassName("drm-collapse")[0],!0),
this.tagFilter=new A(this.createAndInitCheckboxesList(this.form.getElementsByClassName("tags-collapse")[0],!0)),this.initActiveSubmitBtn(),this.form.onsubmit=(t=>this.onSubmit(t)),this.form.addEventListener("save.stop",()=>this.stopSave()),jQuery(document).trigger("initTooltips")}createAndInitCheckboxesList(t,e){let i={summary:t.querySelector("a.form-control .value"),allowEmpty:e};this.hasCounters&&(i.changesInputSelector=".changes-input");let s=new n(t.getElementsByClassName("filter")[0],i)
;return s.getActiveLength()>0?t.classList.add("active"):t.classList.remove("active"),s.filter.addEventListener("deactivate",()=>{t.classList.remove("active")}),s.input.addEventListener("change",()=>{setTimeout(()=>{s.isActive()&&t.classList.add("active")},500)}),s}initActiveSubmitBtn(){this.activeSubmitBtn.afterEnabled=(()=>{this.setSubmitBtnTitle("")})}onSubmit(t){t.preventDefault(),t.stopImmediatePropagation(),this.form.dispatchEvent(new Event("save.start")),this.form.classList.add("sending"),
this.activeSubmitBtn.save(),this.progressBar.active(),this.progressBar.set(0),this.isMultiple&&this.gamesIds.length>=this.submitBatchLimit?this.batchSubmit():this.singleSubmit()}singleSubmit(){this.progressBar.set(50),$.ajax(this.form.action,{type:"POST",data:this.serialize(),dataType:"json",success:t=>{this.progressBar.set(100),this.onSuccess(t)},error:()=>this.onError()})}batchSubmit(){this.submitBatch=this.createSubmitBatch(),this.submitBatch.send(this.serialize())}createSubmitBatch(){
var e=this.form.action.split("?")[0],i=new t.KeysUrlsBatchGenerator(e,this.gamesIds).generate(this.submitBatchLimit),s=new t.SubmitBatch(i);return s.onDone=((t,e,i)=>{this.progressBar.set(e.length/i.length*100)}),s.onAllLoad=(t=>{200!==t.status?this.onError():this.onSuccess(JSON.parse(t.response))}),s}onSuccess(t){t.code===l.FORM_FAIL_VALIDATION&&this.onError(v.errorsToString(t.errors)),t.code===l.SUCCESS&&this.onSuccessSave(),this.processFlashesFromResponse(t)}onError(t){
this.activeSubmitBtn.unsave(),this.progressBar.set(0),this.progressBar.hide(),t?c(t):c()}stopSave(){this.submitBatch&&this.submitBatch.stop()}}e.Form=v,e.afterValidateAttribute=function(t,e,a,n){r(a)?i.activeSubmitBtn.enabled():(i.setSubmitBtnTitle(s.errorsToString(a)),i.activeSubmitBtn.disabled())},e.create=function(t,e){(i=new v(t,e)).init()};class A{constructor(t){this.filter=t,this.createTag=new C(this.filter.filter.querySelector(".create-tag-wrapper"),this.filter.getItemsNames()),
this.init()}init(){this.createTag.onPostDone=(t=>this.onSuccessCreate(t)),this.filter.afterMarkItemAsEdit=(t=>this.createEditForm(t))}onSuccessCreate(t){if(t.element){let e=h(t.element);this.filter.addItem(e,this.filter.getItemsLength()-1,!0),this.createTag.notAvailableNames=this.filter.getItemsNames(),this.createTag.input.value="",this.createTag.input.dispatchEvent(new Event("resize")),this.createTag.validate()}}createEditForm(t){let e=this.filter.getName(t)
;this.editTag=new C(t,this.filter.getItemsNames().filter(t=>t!==e)),this.editTag.onPostDone=(t=>this.onSuccessEdit(t))}onSuccessEdit(t){if(t.element){let e=h(t.element);this.filter.findItem(this.filter.getKey(e)).querySelector(".filter-name").outerHTML=e.querySelector(".filter-name").outerHTML}this.filter.unmarkActiveEditItem(),this.filter.updateStringValue(),this.filter.updateSummary()}}class C{constructor(t,e=[]){this.notAvailableNames=[],this.wrapper=t,
this.colors=new S(this.wrapper.querySelectorAll(".color-bull")),this.input=this.wrapper.querySelector("input"),this.btn=new u(this.wrapper.querySelector("[type=button]")),this.notAvailableNames=e,this.init()}init(){this.btn.btn.addEventListener("click",()=>this.submit()),this.colors.afterColorClick=(()=>this.validate()),this.input.addEventListener("keyup",()=>this.validate()),o(this.input),this.validate()}validate(){return Helpers.String.isEmpty(this.input.value)?(this.btn.hide(),
this.btn.setTitle("Name must be set."),void this.btn.disabled()):(this.btn.show(),this.isUniqueName()?(this.btn.setTitle(""),void this.btn.enabled()):(this.btn.setTitle("Name must be unique."),void this.btn.disabled()))}isUniqueName(){let t=this.getName().toLowerCase();return!this.notAvailableNames.some(e=>(e=e.toLowerCase().trim(),t===e))}getName(){return this.input.value.trim()}getColor(){return this.colors.getActiveColorKey()}submit(){this.btn.save(),
$.post(this.getSubmitUrl(),this.getData()).done(t=>{this.btn.unsave(),this.onPostDone(t)}).fail(()=>{this.btn.unsave(),c()})}getSubmitUrl(){return this.btn.btn.dataset.url}getData(){return{name:this.getName(),color:this.getColor()}}onPostDone(t){}}class S{constructor(t){this.activeColor=null,this.colors=t,this.activeColor=[...this.colors].find(t=>t.classList.contains("active")),this.init()}init(){this.colors.forEach(t=>t.addEventListener("click",t=>this.onColorClick(t)))}onColorClick(t){
this.activeColor&&this.activeColor.classList.remove("active"),this.activeColor=t.currentTarget,this.activeColor.classList.add("active"),this.afterColorClick()}afterColorClick(){}getActiveColorKey(t="data-key"){return this.hasActiveColor()?this.activeColor.getAttribute(t):null}hasActiveColor(){return this.activeColor instanceof HTMLElement}}}(t.Collection||(t.Collection={}))}(Forms||(Forms={})),function(t){!function(t){t.FiltersList=class extends t.BaseFilter{constructor(t,e){super(t),
this.filters=[],this.filterSelector=".filter",this.setManager(e),this.filter.querySelectorAll(this.filterSelector).forEach(t=>{let e=this.getManager().get(t.getAttribute("id"));null!==e&&this.filters.push(e)}),this.init()}init(){this.isActive()||this.hasActiveFilter()&&this.active(),this.filters.forEach(t=>{t.filter.addEventListener("active",()=>this.active()),t.filter.addEventListener("deactivate",()=>this.deactivate())})}deactivate(){this.hasActiveFilter()||super.deactivate()}
hasActiveFilter(){return this.filters.some(t=>t.isActive())}clear(){}}}(t.Filter||(t.Filter={}))}(Forms||(Forms={})),function(t){!function(t){var e=Helpers.Forms.inputClearOnFocus,i=Helpers.Forms.inputRestoreValueOnFocusOut,s=Data.RangeValues,a=Data.RangeCompare,n=Helpers.String.filterNumber;class r{constructor(t,e){this.ranges=[],this.items=t,this.items.forEach((t,e)=>{this.addRange(e,t),t.addEventListener("click",t=>this.onClick(t))}),this._isActive=void 0!==this.getActiveItem(),
this.inputWrapper=e}addRange(t,e){this.ranges[t]=r.createRangeFromItem(e)}static createRangeFromItem(t){return new c(t.getAttribute("data-min"),t.getAttribute("data-max"))}isActive(){return this._isActive}onClick(t){this.unselectActiveOption();var e=t.currentTarget;e.classList.add("active"),this.activeRange=r.createRangeFromItem(e),this._isActive=!0,this.afterClick()}afterClick(){}unselectActiveOption(){this._isActive=!1;let t=this.getActiveItem();t&&(this.inputWrapper.classList.add("active"),
t.classList.remove("active"))}getActiveItem(){return[...this.items].find(t=>t.classList.contains("active"))}getActiveRange(){return this.activeRange}set(t,e){this._isActive&&this.unselectActiveOption(),t.compare(e)!==a.SAME&&this.activeItemFromRange(t)}activeItemFromRange(t){let e=this.ranges.findIndex(e=>e.compare(t)===a.SAME);-1!==e&&(this.items.item(e).classList.add("active"),this._isActive=!0)}}class o extends t.BaseFilter{constructor(t){super(t),this.field=t.getAttribute("data-field"),
this.minSelectedInput=this.getMinSelectedInput(t),this.maxSelectedInput=this.getMaxSelectedInput(t),this.minRangeInput=this.getMinRangeInput(),this.maxRangeInput=this.getMaxRangeInput(),this.rangeSlider=new l(this.getRangeSliderInput()),this.forcedMinValue=this.getForcedMinRangeValue(),this.init()}init(){e(this.minRangeInput),i(this.minRangeInput),e(this.maxRangeInput),i(this.maxRangeInput),this.initRangeOption()}initRangeOption(){
this.rangeOption=new r(this.filter.querySelectorAll(".predefine-item"),this.filter),this.rangeOption.afterClick=(()=>this.afterRangeOptionClick())}afterRangeOptionClick(){this.range=this.rangeOption.getActiveRange(),this.updateValues(),this.rangeSlider.update(this.range)}initRangeSlider(t){var e=c.createFromInputs(this.minSelectedInput,this.maxSelectedInput,!1);this.rangeSlider.$input.ionRangeSlider({from:e.from,to:e.to,onChange:t=>this.onSliderChange(t,o.SLIDER_ACTIVE_RANGE_TIMEOUT),
prettify:t.prettify,step:t.step}),this.sliderBar=this.filter.querySelector(".range-slider"),this.maxRangeInput.addEventListener("change",()=>this.changeRangeValue()),this.minRangeInput.addEventListener("change",()=>this.changeRangeValue()),this.maxRangeInput.addEventListener("keyup",()=>this.changeRangeValue(o.KEYUP_TIMEOUT)),this.minRangeInput.addEventListener("keyup",()=>this.changeRangeValue(o.KEYUP_TIMEOUT)),isNaN(e.from)&&isNaN(e.to)&&this.setDefault(),
this.forcedMinValue&&parseFloat(this.minSelectedInput.value)===this.forcedMinValue&&(this.minSelectedInput.value=""),this.setSliderAttributes()}changeRangeValue(t=0){this.range=c.createFromInputs(this.minRangeInput,this.maxRangeInput,!0),this.range.recalculateWithScale(this.rangeSlider.scaleRange),this.timeout&&clearTimeout(this.timeout),this.timeout=window.setTimeout(()=>{this.updateValues(),this.rangeSlider.update(this.range),this.rangeOption.set(this.range,this.rangeSlider.scaleRange)},t)}
onSliderChange(t,e=0){this.range=new c(t.from,t.to),this.updateValues(),this.sliderChangeTimeout&&clearTimeout(this.sliderChangeTimeout),this.sliderChangeTimeout=window.setTimeout(()=>{this.rangeOption.set(this.range,this.rangeSlider.scaleRange),this.setSliderAttributes()},e),""===this.minSelectedInput.value&&""===this.maxSelectedInput.value&&this.deactivate()}clear(){this.deactivate(),this.setDefault()}setDefault(){this.setDefaultMin(),this.setDefaultMax(),this.rangeSlider.setDefault(),
this.setSliderAttributes()}active(){super.active(),this.filter.classList.add("active"),this.sliderBar.classList.add("active"),this.minRangeInput.classList.add("active"),this.maxRangeInput.classList.add("active")}deactivate(){super.deactivate(),this.filter.classList.remove("active"),this.sliderBar.classList.remove("active"),this.rangeOption.unselectActiveOption(),this.maxRangeInput.classList.remove("active"),this.minRangeInput.classList.remove("active")}updateValues(){
var t=this.range.compare(this.rangeSlider.scaleRange);t===a.OVER||t===a.SAME&&!1===this.getForcedMinRangeValue()?this.clear():(this.active(),this.setMin(),this.setMax()),this.setSliderAttributes(),this.clearRelatedOnChange()&&this.clearRelated()}setSliderAttributes(){if(this.sliderBar.setAttribute("data-value-from",this.minRangeInput.value),this.sliderBar.setAttribute("data-value-to",this.maxRangeInput.value),$(this.sliderBar).find(".irs-single").length){
let t=$(this.sliderBar).attr("data-after-label");t&&$(this.sliderBar).find(".irs-single").html(this.minRangeInput.value+t)}}setMin(){this.setRangeInput(this.minRangeInput,this.rangeSlider.formatValue(this.range.from)),this.setMinSelected(String(this.range.from))}setRangeInput(t,e){t.value=e,t.placeholder=e}setDefaultMin(){let t=this.rangeSlider.scaleRange.from,e="";this.rangeSlider.input.hasAttribute("data-default-value")&&(t=parseFloat(this.rangeSlider.input.getAttribute("data-default-value")),
e=this.rangeSlider.input.getAttribute("data-default-value")),this.setMinSelected(e),this.setRangeInput(this.minRangeInput,this.rangeSlider.formatValue(t))}setMinSelected(t){let e=this.rangeSlider.scaleRange.from;this.minSelectedInput.value=t,e!==this.forcedMinValue&&this.forcedMinValue?parseFloat(this.minSelectedInput.value)===this.forcedMinValue&&(this.minSelectedInput.value=""):parseFloat(this.minSelectedInput.value)===e&&(this.minSelectedInput.value=""),
this.triggerChange(this.minSelectedInput)}setMax(){this.range.to===this.rangeSlider.scaleRange.to?this.setDefaultMax():(this.setRangeInput(this.maxRangeInput,this.rangeSlider.formatValue(this.range.to)),this.setMaxSelected(String(this.range.to)))}setMaxSelected(t){let e=this.rangeSlider.scaleRange.to;this.maxSelectedInput.value=t,parseFloat(t)===e&&(this.maxSelectedInput.value=""),this.triggerChange(this.maxSelectedInput)}setDefaultMax(){this.setMaxSelected(""),
this.setRangeInput(this.maxRangeInput,this.rangeSlider.formatValue(this.rangeSlider.scaleRange.to))}triggerChange(t){t.dispatchEvent(new Event("change"))}getMinSelectedInput(t){return this.filter.querySelector("#"+t.getAttribute("data-min-input-id"))}getMaxSelectedInput(t){return this.filter.querySelector("#"+t.getAttribute("data-max-input-id"))}getForcedMinRangeValue(){
return!!this.minRangeInput.hasAttribute("data-default-value")&&parseFloat(this.minRangeInput.getAttribute("data-default-value"))}getMinRangeInput(){return this.filter.querySelector("#min-"+this.field+"-range")}getMaxRangeInput(){return this.filter.querySelector("#max-"+this.field+"-range")}getRangeSliderInput(){return this.filter.querySelector("#"+this.field+"-range-slider")}}o.KEYUP_TIMEOUT=600,o.SLIDER_ACTIVE_RANGE_TIMEOUT=300,t.RangeFilter=o;class l{constructor(t){this.input=t,
this.$input=$(t),this.prefix=t.getAttribute("data-prefix"),this.suffix=t.getAttribute("data-suffix"),this.scaleRange=new c(this.getMin(),this.getMax()),this.defaultRange=new c(this.getDefaultMin(),this.getMax())}formatValue(t){return this.prefix+t+this.suffix}getDefaultMin(){return this.input.hasAttribute("data-default-value")?parseFloat(this.input.getAttribute("data-default-value")):parseFloat(this.input.getAttribute("data-min"))}getMin(){return parseFloat(this.input.getAttribute("data-min"))}
getMax(){return parseFloat(this.input.getAttribute("data-max"))}setDefault(){this.input.hasAttribute("data-default-value")?this.update(this.defaultRange):this.update(this.scaleRange)}update(t){this.$input.data("ionRangeSlider").update({from:t.from,to:t.to})}}class c extends s{static createFromInputs(t,e,i=!0){return new this(this.getValue(t,i),this.getValue(e,i))}static getValue(t,e){let i=t.value;return e&&(i=n(i)),parseFloat(i)}}}(t.Filter||(t.Filter={}))}(Forms||(Forms={})),function(t){
!function(t){var e=Helpers.Forms.copyPlaceholder,i=Helpers.Forms.restorePlaceholder;t.MainNameFilter=class extends t.OneInputFilter{init(){super.init(),e(this.input),this.filter.addEventListener("click",t=>this.onFilterClick(t)),this.input.addEventListener("focusout",()=>this.onInputFocusOut()),this.input.addEventListener("keyup",t=>this.onItemKeyUp(t)),this.setOnlyNewValue=!1}onFilterClick(t){this.active(),this.focusInput()}onInputFocusOut(){this.isEmpty()&&this.deactivate()}onItemKeyUp(t){
this.setValue(this.getValue())}deactivate(){super.deactivate(),this.isEmpty()&&i(this.input)}}}(t.Filter||(t.Filter={}))}(Forms||(Forms={})),function(t){!function(t){class e{constructor(){this.$filters=e.findFilters(),this.hasFilters()&&e.initRemoveFilterEvents()}static disactive(){this.findFilters().removeClass("active")}static findFilters(){return $(this.SELECTOR_FILTERS)}hasFilters(){return 1===this.$filters.length}static initRemoveFilterEvents(){
this.isRegisterEvents||(this.isRegisterEvents=!0,jQuery(document).on("click",e.REMOVE_FILTER_SELECTOR,t=>this.onRemoveBtnClick($(t.currentTarget))),jQuery(document).on("click",e.REMOVE_ALL_FILTER_SELECTOR,t=>this.onRemoveAllClick(t)))}static onRemoveAllClick(t){(new this).$filters.children().remove(),this.registerRemoveAllFilterEvent(),t.preventDefault(),showResetFlash("All filters cleared","")}static registerRemoveAllFilterEvent(){jQuery(document).trigger(e.EVENT_REMOVE_ALL_FILTER),
jQuery(".filter-line").removeClass("show-more")}static onRemoveBtnClick(t){(new this).removeFilter(t)}removeFilter(t){t.remove();var i=t.data("filter-id");e.registerRemoveFilterEvent(i);var s=jQuery("#"+i);if(s.find(".item.active-exclude").each(function(){jQuery(this).removeClass("active-exclude")}),s.find(".filter-switch-match-all").length){var a=s.find(".filter-match-all-trigger").find("input");a.val(""),a.trigger("change"),a[0].dispatchEvent(new Event("change")),
a.val()===a.attr("data-unselect-value")?s.find(".filter-switch-match-all").removeClass("active"):s.find(".filter-switch-match-all").addClass("active")}var n=this.getActiveFilterLength();n<2&&this.removeClearAllFilters(),0===n&&this.disactive()}disactive(){this.$filters.removeClass("active")}static registerRemoveFilterEvent(t){jQuery(document).trigger(e.EVENT_REMOVE_FILTER,[t])}getActiveFilterLength(){return this.$filters.find(".active").length}removeClearAllFilters(){
this.$filters.find(e.REMOVE_ALL_FILTER_SELECTOR).remove(),this.$filters.find(e.FILTERS_BUTTONS_CONTAINER_SELECTOR).remove(),this.$filters.find(e.SELECTOR_FILTERS).html("")}}e.SELECTOR_FILTERS="#selected-filters",e.EVENT_REMOVE_FILTER="remove-filter",e.EVENT_REMOVE_ALL_FILTER="remove-all-filters",e.isRegisterEvents=!1,e.REMOVE_FILTER_SELECTOR=".remove-filter",e.REMOVE_ALL_FILTER_SELECTOR=".clear-all-filters",e.FILTERS_BUTTONS_CONTAINER_SELECTOR=".filters-side-buttons-container",
t.ActiveFilterManager=e}(t.Filter||(t.Filter={}))}(Forms||(Forms={})),function(t){!function(t){t.DateRangePicker=class extends t.BaseFilter{constructor(t,e){Helpers.Object.isUndefined(e.fromOptions)&&(e.fromOptions={}),Helpers.Object.isUndefined(e.toOptions)&&(e.toOptions={}),e.onlyYears&&(e.fromOptions.viewMode="years",e.toOptions.viewMode="years"),super(t,e),this.fromInput=document.getElementById(this.options.fromId),this.toInput=document.getElementById(this.options.toId),
this.$fromPicker=this.createFromPicker(),this.$toPicker=this.createToPicker(),this.registerEvents(),this.init()}init(){this.$toPicker.trigger("blur"),this.$fromPicker.trigger("blur"),this.setMinMax(),super.init()}setMinMax(){this.fromInput.value.length&&this.$toPicker.data("DateTimePicker").minDate(this.fromInput.value),this.toInput.value.length&&this.$fromPicker.data("DateTimePicker").maxDate(this.toInput.value)}registerEvents(){this.$fromPicker.on("dp.change",t=>{
!1!==t.date?(this.$toPicker.data("DateTimePicker").minDate(t.date),this.fromInput.classList.add("active"),this.active(),0===this.toInput.value.length&&this.toInput.focus()):(this.$toPicker.data("DateTimePicker").minDate(!1),this.fromInput.classList.remove("active"),this.toInput.classList.contains("active")&&this.deactivate()),this.triggerChange(this.fromInput),this.clearRelatedOnChange()&&this.clearRelated(),this.$fromPicker.data("DateTimePicker").hide()}),this.$toPicker.on("dp.change",t=>{
!1!==t.date?(this.$fromPicker.data("DateTimePicker").maxDate(t.date),this.active(),this.toInput.classList.add("active")):(this.$fromPicker.data("DateTimePicker").maxDate(!1),this.toInput.classList.remove("active"),this.fromInput.classList.contains("active")&&this.deactivate()),this.triggerChange(this.toInput),this.$toPicker.data("DateTimePicker").hide(),this.$fromPicker.data("DateTimePicker").hide(),this.clearRelatedOnChange()&&this.clearRelated()}),
this.$fromPicker.on("dp.error",()=>this.disactiveInput(this.fromInput)),this.$toPicker.on("dp.error",()=>this.disactiveInput(this.toInput)),this.options.onlyYears&&(this.$fromPicker.on("dp.update",t=>{"YYYY"===t.change&&this.isSelectYear()&&(this.$fromPicker.data("DateTimePicker").date(new Date(t.viewDate.get("year"),0,1)),this.$fromPicker.data("DateTimePicker").viewMode("years"))}),this.$toPicker.on("dp.update",t=>{
"YYYY"===t.change&&this.isSelectYear()&&(this.$toPicker.data("DateTimePicker").date(new Date(t.viewDate.get("year"),11,31)),this.$toPicker.data("DateTimePicker").viewMode("years"))}))}isSelectYear(){return this.isHidden(".datepicker-decades")&&this.isHidden(".datepicker-years")}isHidden(t){return"none"===this.filter.querySelector(t).style.display}createFromPicker(){return this.createPicker(this.fromInput,this.options.fromOptions)}createToPicker(){
return this.createPicker(this.toInput,this.options.toOptions)}createPicker(t,e){return $(t).datetimepicker(e)}clear(){this.deactivate(),this.disactiveInput(this.fromInput),this.disactiveInput(this.toInput),this.$fromPicker.data("DateTimePicker").maxDate(!!this.options.fromOptions.maxDate&&this.options.fromOptions.maxDate),this.$toPicker.data("DateTimePicker").minDate(!!this.options.toOptions.minDate&&this.options.toOptions.minDate)}disactiveInput(t){t.classList.remove("active"),t.value="",
this.triggerChange(t)}triggerChange(t){t.dispatchEvent(new Event(t.getAttribute("data-event-type")))}}}(t.Filter||(t.Filter={}))}(Forms||(Forms={})),function(t){!function(t){!function(e){let i;!function(t){t.RADIO_LIST="radio-list",t.SORT_RADIO_LIST="sort-radio-list",t.VIEW_RADIO_LIST="view-radio-list",t.PAGE_SIZE_RADIO_LIST="page-size-radio-list",t.SINGLE_CHECKBOX="single-checkbox",t.CHECKBOXES_LIST="checkboxes-list",t.RANGE="range",t.MAIN_NAME="main-name",t.FILTER_LIST="filter-list"
}(i||(i={}));class s{constructor(){this.filters={},this.filterTypeAttribute="data-filter-type",this.initRemoveFilters()}createFilter(e){switch(e.getAttribute(this.filterTypeAttribute)){case i.RADIO_LIST:return new t.RadioFilter(e);case i.VIEW_RADIO_LIST:return new t.ViewRadioFilter(e);case i.PAGE_SIZE_RADIO_LIST:return new t.PageSizeRadioFilter(e);case i.CHECKBOXES_LIST:return new t.CheckboxesListFilter(e);case i.SINGLE_CHECKBOX:return new t.SingleFilter(e);case i.SORT_RADIO_LIST:
return new t.SortRadioFilter(e);case i.MAIN_NAME:return new t.MainNameFilter(e);case i.FILTER_LIST:return new t.FiltersList(e,this);default:return null}}initRemoveFilters(){(new t.ActiveFilterManager).hasFilters()&&(jQuery(document).on(t.ActiveFilterManager.EVENT_REMOVE_FILTER,(t,e)=>{var i=this.get(e);i&&this.clean(i)}),jQuery(document).on(t.ActiveFilterManager.EVENT_REMOVE_ALL_FILTER,()=>this.cleanAll()))}has(t){return this.filters.hasOwnProperty(t)}addFilter(t){t.setManager(this),
this.filters[t.id]=t}get(t){if(this.has(t))return this.filters[t];let e=document.getElementById(t);if(e){let t=this.createFilter(e);return t&&this.addFilter(t),t}return null}clean(t){t.notClear||(t.clear(),t.clearRelated())}cleanAll(){var e=[];for(let t in this.filters){var i=this.get(t);i.isFullPageRefresh()?e.push(i):this.clean(this.get(t))}e.forEach(function(t){this.clean(t)},this),t.ActiveFilterManager.disactive()}}var a;function n(){return a||(a=new s),a}e.initRangeFilter=function(e,i){
if(e.hasAttribute("id")){let a=e.getAttribute("id");if(!n().has(a)){var s=new t.RangeFilter(e);s.initRangeSlider(i),n().addFilter(s)}}},e.initDateRangeFilter=function(e,i){if(e.hasAttribute("id")){let s=e.getAttribute("id");n().has(s)||n().addFilter(new t.DateRangePicker(e,i))}},e.instance=n,e.initFilters=function(t){n(),document.querySelectorAll(t).forEach(t=>{if(t.hasAttribute("id")){let e=t.getAttribute("id");a.has(e)||a.addFilter(a.get(e))}}),
$(".navigation-line .page-size-filter").length&&$(".navigation-line").on("click",".filter-dropdown.page-size-filter .dropdown-content .item .link",function(){var t=$(this).closest(".item").attr("data-value"),e=$(this).closest(".filter-dropdown").find("input");$(this).closest(".filter-dropdown").find(".current .value").text(t),e.val(t),e.trigger("change")})},e.triggerInit=function(){document.dispatchEvent(new Event("initFilters"))}}(t.Manager||(t.Manager={}))}(t.Filter||(t.Filter={}))
}(Forms||(Forms={})),function(t){!function(t){t.removeHash=function(){var t,e,i=window.location;i.hash.length>0&&("pushState"in history?history.pushState("",document.title,i.pathname+i.search):(t=document.body.scrollTop,e=document.body.scrollLeft,i.hash="",document.body.scrollTop=t,document.body.scrollLeft=e))},t.parseQueryString=function(t=""){""===t&&(t=window.location.search.substring(1));for(var e=t.split("&"),i={},s=0;s<e.length;s++){
var a=e[s].split("="),n=decodeURIComponent(a[0]),r=decodeURIComponent(a[1]);if(void 0===i[n])i[n]=decodeURIComponent(r);else if("string"==typeof i[n]){var o=[i[n],decodeURIComponent(r)];i[n]=o}else i[n].push(decodeURIComponent(r))}return i}}(t.Url||(t.Url={}))}(Helpers||(Helpers={})),function(t){var e=Helpers.Object.isUndefined,i=Helpers.Url.parseQueryString;class s{constructor(t){this.listViewID=t,this.getSettings()}update(t){$.fn.yiiListView.update(this.listViewID,t)}getSettings(){
return e(this._settings)&&(this._settings=$.fn.yiiListView.settings[this.listViewID]),this._settings}isEnabledHistory(){return this.getSettings().enableHistory&&!1!==this.getSettings().ajaxUpdate}beforeAjaxUpdate(){this.getList().addClass(this._settings.loadingClass),this._settings.hasOwnProperty("beforeAjaxUpdate")&&this._settings.beforeAjaxUpdate()}afterAjaxUpdate(){this.getList().removeClass(this._settings.loadingClass),
this._settings.hasOwnProperty("afterAjaxUpdate")&&this._settings.afterAjaxUpdate()}getList(){return $("#"+this.listViewID)}static getPageQuery(){var t=i();return t.hasOwnProperty(this.pageVarName)?"&"+this.pageVarName+"="+t[this.pageVarName]:""}}s.pageVarName="page",t.ListView=s}(Widgets||(Widgets={})),function(t){var e=t.Form.BaseForm,i=Helpers.String.isEmpty,s=Widgets.ListView,a=Helpers.Object.isUndefined,n=t.Form.blockSubmitOnEnter,r=Helpers.Forms.inputTimeout;function o(t){
var e=document.getElementById(t).getAttribute("data-form");Helpers.Object.isUndefined(e)?document.getElementById(t)&&$.fn.yiiListView.update(t):function(t){let e=l.instances[t];if(a(e))return void console.log("not found filter form: "+t);e.updateView(location.pathname+location.search)}(e)}t.updateListView=o,t.getFilterFormValue=function(t,e){var i=document.getElementById(t).getAttribute("data-form");return!Helpers.Object.isUndefined(i)&&l.instance(i,t).$inputs.closest("form").find("#"+e).val()},
t.updateCurrentListView=function(){o(document.getElementsByClassName("list-view")[0].getAttribute("id"))};class l extends e{constructor(t,e){super(t,!1),this.inputShouldSearchAttribute="data-pjax-search",this.inputPostAttribute="data-pjax-post",this.listView=new s(e),this.lastUrl=window.location.pathname+window.location.search,n("#"+t),this.init()}static instance(t,e){return this.instances.hasOwnProperty(t)||(this.instances[t]=new l(t,e)),this.instances[t]}init(){this.initPjax(),
this.initChangeUpdate()}initPjax(){a(this.pjax)&&(this.pjax=new Pjax({elements:".pjax-link",selectors:[".pjax-replace",".pjax-inner-replace"],switches:{".pjax-replace":Pjax.switches.outerHTML,".pjax-inner-replace":Pjax.switches.innerHTML},cacheBust:!1,scrollTo:!1,history:this.listView.isEnabledHistory(),scrollRestoration:!1}),document.addEventListener("pjax:send",()=>this.beforeAjaxUpdate()),document.addEventListener("pjax:complete",t=>this.afterAjaxUpdate(t.request)))}beforeAjaxUpdate(){
this.listView.beforeAjaxUpdate()}afterAjaxUpdate(t){Helpers.Dom.executeScript(t.responseText),this.listView.afterAjaxUpdate()}initChangeUpdate(){var t=this;[...this.form.elements].forEach(t=>{if(t.hasAttribute(this.inputShouldSearchAttribute)){let e="change";t.hasAttribute("data-event-type")&&(e=t.getAttribute("data-event-type")),t.addEventListener(e,t=>this.onInputChange(t))}}),
$(".main-content").find(".navigation-line").length&&$(".main-content").on("change",".navigation-line input",e=>t.onInputChange(e))}onInputChange(t){this.searchInterval&&clearInterval(this.searchInterval);var e=t.currentTarget;e.hasAttribute(this.inputPostAttribute)?this.searchInterval=window.setTimeout(()=>this.updatePost(e),r(e)):this.searchInterval=window.setTimeout(()=>this.submitOnNewUrl(e),r(e))}updatePost(t){$.post(t.getAttribute(this.inputPostAttribute),{[t.name]:t.value},()=>{
t.hasAttribute("data-full-reload")?location.reload():this.update()})}submitOnNewUrl(t){var e=this.getUpdateUrl();e!==this.lastUrl&&(t.hasAttribute("data-full-reload")?location.href=e:(this.lastUrl=e,this.update(e)))}update(t){this.updateView(t)}updateView(t){t||(t=this.getUpdateUrl()),this.pjax.loadUrl(t)}getUpdateUrl(){var t=$.param.querystring(this.form.action,this.getData());return t=t.replace("%26",encodeURI("%26")),decodeURIComponent(t)}getData(){return this.markPjaxInput(),
this.$inputs.filter("[data-pjax-search]").not("[data-pjax-post]").serialize()}markPjaxInput(){[...this.form.elements].forEach(t=>{i(t.value)||t.hasAttribute("data-disabled")?t.removeAttribute(this.inputShouldSearchAttribute):t.setAttribute(this.inputShouldSearchAttribute,"")})}}l.instances={},t.FilterForm=l}(Forms||(Forms={})),function(t){!function(t){var e=Widgets.Button.ActiveButton;class i{constructor(t){this.tab=t}setForm(t){this.form=t}getForm(){return this.form}}class s extends i{
constructor(t){super(t),this.back=this.tab.querySelector(s.onBackClass),this.apply=this.tab.querySelector(s.onApplyClass),this.activeApplyBtn=new e(this.apply)}init(){this.apply.addEventListener("click",t=>this.onApply(t)),this.back.addEventListener("click",t=>this.onBack(t)),document.addEventListener("keydown keypress",t=>this.onDocumentKey(t))}onDocumentKey(t){var e=$(t.target);"8"!==t.code||e.is('input,[contenteditable="true"],textarea')||(t.preventDefault(),this.back.click())}onApply(t){}
onBack(t){}}s.onBackClass=".action-back",s.onApplyClass=".action-apply-changes",t.AdvancedTab=s}(t.Tab||(t.Tab={}))}(Forms||(Forms={})),function(t){t.ToggleTextBtn=class{constructor(t){this.text=t,this.baseToggleText=this.text.textContent}setToggleText(t){this.text.textContent=t}restoreToggleText(){this.setToggleText(this.baseToggleText)}}}(Widgets||(Widgets={})),function(t){!function(e){var i=t.Form.ValidateAppendsForm,s=t.Tab.AdvancedTab,a=Widgets.ToggleTextBtn;class n extends i{
constructor(t){super(t)}init(){this.overwrite=new a(this.form.querySelector('[data-toggle="collapse"] .title')),this.nameInput=this.form.querySelector("#SavePresetForm_presetName"),this.overwriteTab=new s(this.form.querySelector("#overwrite-preset")),this.collapseGroup=this.overwriteTab.tab.querySelector(".collapse-group"),this.idInput=this.collapseGroup.getElementsByTagName("input")[0],this.idInput.onchange=(()=>this.onOverwriteChange()),this.overwriteTab.init(),this.restore(),
this.form.querySelector(".action-back").addEventListener("click",()=>this.restore()),this.form.addEventListener("submit",t=>this.onSubmit(t))}restore(){this.overwrite.restoreToggleText(),this.idInput.value="",this.nameInput.value="",setTimeout(()=>{this.activeSubmitBtn.disabled()},1e3),this.collapseGroup.getElementsByClassName("form-control")[0].classList.remove("active")}onOverwriteChange(){let t=this.collapseGroup.querySelector('[data-key="'+this.idInput.value+'"]').textContent
;t?(this.overwrite.setToggleText(t),this.activeSubmitBtn.enabled()):this.activeSubmitBtn.disabled()}onSubmit(t){t.preventDefault(),$.ajax(this.form.action,{type:"POST",data:this.serialize(),success:function(){location.reload()}})}}let r={};e.create=function(t){return r[t]=new n(t),r[t]},e.get=function(t){return r[t]?r[t]:this.create(t)}}(t.Preset||(t.Preset={}))}(Forms||(Forms={})),Array.prototype.forEach||(Array.prototype.forEach=function(t){var e=this.length
;if("function"!=typeof t)throw new TypeError;for(var i=arguments[1],s=0;s<e;s++)s in this&&t.call(i,this[s],s,this)}),Array.prototype.filter||(Array.prototype.filter=function(t){var e=this.length;if("function"!=typeof t)throw new TypeError;for(var i=[],s=arguments[1],a=0;a<e;a++)if(a in this){var n=this[a];t.call(s,n,a,this)&&i.push(n)}return i}),function(t){class e{constructor(t,e){this.initSelector=".timeago",this.element=t,e&&(this.initSelector=e)}getTime(){
return this.element.getAttribute("datetime")}getText(){return this.element.innerText}setTime(t){t&&(timeago.cancel(this.element),this.element.setAttribute("datetime",t),this.element.title=e.getUTC(t),this.element.classList.add("init-timeago"),initScripts("timeago",function(t){timeagoInstance.render(t.toArray(),"en_full")}))}static getUTC(t){return moment(t).utc().format("YYYY-MM-DD H:mm UTC")}}t.Timeago=e}(Widgets||(Widgets={})),function(t){var e=Helpers.Time.timeCutter;class i{constructor(t){
this.expiredText="Expired: ",this.closeToEndInterval=864e5,t.hasAttribute(i.ATTRIBUTE_DATETIME)&&(this.element=t,this.time=1e3*parseInt(this.element.getAttribute(i.ATTRIBUTE_DATETIME)),i.instances.push(this))}update(t){var i=this.time-t;return i>0?(this.updateText(this.format(e(i))),i<this.closeToEndInterval&&this.markCloseToEnd(),!0):(this.unmarkCloseToEnd(),this.markAsExpired(),this.changeToTimeago(),!1)}updateText(t){this.element.innerHTML=t}markCloseToEnd(){
this.element.parentElement.classList.add("close-to-end")}unmarkCloseToEnd(){this.element.parentElement.classList.remove("close-to-end")}markAsExpired(){null!==this.element.parentElement.querySelector(".expiry-label")&&this.element.parentElement.querySelector(".expiry-label").remove(),this.element.parentElement.classList.add("expired"),this.element.insertAdjacentHTML("beforebegin",'<span class="expired-text">'+this.expiredText+"</span>")}changeToTimeago(){
this.element.classList.add("timeago-short"),this.element.classList.add("init-timeagoShort"),clearTimeout(i.TIMEAGO_TIMEOUT),i.TIMEAGO_TIMEOUT=window.setTimeout(()=>{initScripts("timeagoShort",function(t){timeagoInstance.render(t.toArray(),"en_short")})},100)}format(t){var e="";return t.days>0&&(e+=t.days+"d "),t.hours>=0&&(t.hours<10&&(e+="0"),e+=t.hours+":"),t.minutes>=0&&(t.minutes<10&&(e+="0"),e+=t.minutes+":"),t.seconds>=0&&(t.seconds<10&&(e+="0"),e+=t.seconds),e}static run(){
-1===this.interval&&(this.onInterval(),this.interval=window.setInterval(()=>this.onInterval(),1e3))}static onInterval(){var t=this.instances.length;0===this.instances.length&&clearInterval(this.interval);for(var e=(new Date).getTime();t--;){this.instances[t].update(e)||this.instances.splice(t,1)}}static clear(){clearInterval(this.interval),this.interval=-1,this.instances=[]}static render(t){for(var e=0,s=t.length;e<s;++e)new i(t[e]);clearInterval(this.interval),this.interval=-1,i.run()}}
i.instances=[],i.interval=-1,i.ATTRIBUTE_DATETIME="data-timestamp",t.CountDownTimer=i}(Utils||(Utils={})),function(t){var e=Helpers.Object.isUndefined,i=Helpers.Url.removeHash;class s{constructor(t,e){this.handler=t,this.options=e,this.parseOptions()}parseOptions(){e(this.options.triggerName)||jQuery(document).on(this.options.triggerName,()=>this.init())}init(){this.isOnClick()&&this.initOnClick(),this.isOnLoad()&&this.initOnLoad()}isOnClick(){return this.options.onClick}initOnClick(){
$("body").on("click",this.getAnchorSelector(),t=>this.onAnchorClick(t))}onAnchorClick(t){var i=$(t.currentTarget),s=e(i.attr("href"))?i.attr("data-hash"):i.attr("href");!0===this.options.preventDefault&&t.preventDefault(),this.callHandlerIfHashExist(s)}filterHash(t){var e=t.split("#");return 2===e.length?"#"+e[1]:""}isOnLoad(){return this.options.onLoad}initOnLoad(){$(document).on("ready",()=>{$(window).on("load",()=>{setTimeout(()=>{
window.location.hash.length&&this.callHandlerIfHashExist(window.location.hash)},this.getOnLoadTimeout())})})}callHandlerIfHashExist(t){this.isHashExist(t)&&(!0===this.options.removeHash&&i(),this.handler(this.filterHash(t)))}getOnLoadTimeout(){return this.options.onLoadTimeout>0?this.options.onLoadTimeout:0}}t.StringHashHandler=class extends s{constructor(t,e,i){super(e,i),this.baseHash=t,this.init()}getAnchorSelector(){return'a[href*="'+this.baseHash+'"]:not([href="#"])'}filterHash(t){
return t=super.filterHash(t),!0===this.options.onePartHash?t:this.getAfterBaseHash(t)}getAfterBaseHash(t){return t.substr(this.baseHash.length)}isHashExist(t){return t.substr(0,this.baseHash.length)===this.baseHash}};t.ArrayHashHandler=class extends s{constructor(t,e,i){super(e,i),this.availableHashes=t,this.init()}getAnchorSelector(){return"a[href*='#']:not([href='#']), [data-hash]"}isHashExist(t){var e=!1;return this.availableHashes.forEach(i=>{if(!0===this.options.onePartHash){
if(i===t)return void(e=!0)}else e=-1!==t.indexOf(i)}),e}}}(Utils||(Utils={})),function(t){t.Interval=class{constructor(t){this.timeout=t}start(t){this.intervalID||(t&&this.handler(),this.intervalID=setInterval(this.handler,this.timeout))}stop(){clearInterval(this.intervalID),this.intervalID=null}}}(Utils||(Utils={})),function(t){!function(t){let e=!1;t.init=function(){e||document.querySelectorAll(".panel-group .full-item-click").forEach(t=>{t.addEventListener("click",e=>{
e.target.hasAttribute("href")||$(t.querySelector("[data-toggle]")).trigger("click")})})}}(t.Accordion||(t.Accordion={}))}(Widgets||(Widgets={})),function(t){class e{constructor(t,e){this.totalSelectedInfo=!1,this.container=document.getElementById(t);var i=this.container.querySelector(this.getTotalSelectInfoSelector());null!==i&&(this.totalSelectedInfo=new a(i)),this.createdItems(e),this.createdActions(),this.init()}getTotalSelectInfoSelector(){return".total-item-action"}init(){this.items.init(),
this.uncheckedAll(),this.registerEvents()}createdActions(){this.actions=new s(this.container.querySelector(this.getMassContainerSelector()))}getMassContainerSelector(){return".mass-actions-wrapper"}createdItems(t){this.items=new n(t)}registerEvents(){this.items.afterChange=(t=>this.afterItemChange(t)),this.actions.onSelectAllClick=(()=>this.checkedAll()),this.actions.onDeselectAllClick=(()=>this.uncheckedAll()),
this.totalSelectedInfo&&(this.totalSelectedInfo.element.addEventListener(a.EVENT_ACTIVE,()=>this.markAsTotalSelectActive()),this.totalSelectedInfo.element.addEventListener(a.EVENT_INACTIVE,()=>this.unmarkAsTotalSelectActive())),$(".actions-list").on("click",".manage-actions-mobile",function(t){t.preventDefault(),$(".mass-container").addClass("manage-items")})}afterItemChange(t){let e=this.items.getSelectedList(),i=this.items.getSelectedCount()
;$(".total-item-wrapper").find(".total-item-action").removeClass("active"),$(".mass-container").hasClass(a.TOTAL_ITEMS_ACTIVE_CLASS)&&(this.unmarkAsTotalSelectActive(),$(".list-checkbox-action-select-all").removeClass("selected")),this.actions.selected.forEach(t=>{if(t.isAutoTitle)if(t.isOnlyForItemClass||t.isOnlyForItemNotClass){var s=this.getFilterList(t);t.setCount(s.length),t.hasUrl&&t.updateUrl(n.getKeys(s))}else t.setCount(i),t.hasUrl&&t.updateUrl(n.getKeys(e))}),
i>0?($(".mass-selected-items").find(".mass-selected-items-value").text(i),this.markAsActive()):this.unmarkAsActive(),$(".total-items-to-select-wrapper").length&&(i>=this.items.getTotalCount()?$(".total-items-to-select-wrapper").find(".total-item-action").removeClass("hidden"):$(".total-items-to-select-wrapper").find(".total-item-action").addClass("hidden")),i>0?($(".list-checkbox-action-select-all").addClass("selected-part"),
i===this.items.getTotalCount()?$(".list-checkbox-action-select-all").addClass("selected"):$(".list-checkbox-action-select-all").removeClass("selected")):$(".list-checkbox-action-select-all").removeClass("selected selected-part")}getFilterList(t){var e=this.items.getSelectedList();return t.isOnlyForItemClass&&(e=e.filter(e=>e.hasClass(t.itemClass))),t.isOnlyForItemNotClass&&(e=e.filter(e=>!e.hasClass(t.itemNotClass))),e}uncheckedAll(){this.items.uncheckedAll(),
this.totalSelectedInfo&&this.unmarkAsTotalSelectActive(),this.unmarkAsActive()}checkedAll(){this.items.checkedAll()}markAsActive(){this.container.classList.add("mass-edit-active")}unmarkAsActive(){this.container.classList.remove("mass-edit-active"),$(".total-items-to-select-wrapper").find(".total-item-action").addClass("hidden")}markAsTotalSelectActive(){this.container.classList.add(a.TOTAL_ITEMS_ACTIVE_CLASS),$(".list-checkbox-action-select-all").addClass("selected"),
$(".mass-selected-items-value").text($(".total-item-action").attr("data-total-items-count")),$(".total-items-to-select-wrapper").find(".total-item-action").removeClass("hidden")}unmarkAsTotalSelectActive(){this.container.classList.remove(a.TOTAL_ITEMS_ACTIVE_CLASS),$(".list-checkbox-action-select-all").removeClass("selected"),$(".mass-container").find(".with-checkbox").each(function(){$(this).removeClass("selected"),$(this).find("input.regular-checkbox")[0].checked=!1}),
$(".action-dropdown-select-all").addClass("active"),$(".action-dropdown-deselect-all").removeClass("active selected"),$(".total-items-to-select-wrapper").find(".total-item-action").addClass("hidden")}}t.MassActionsManager=e;t.GameMassActionsManager=class extends e{createdItems(t){this.items=new r(t)}getItems(){return this.items}};class i{constructor(t){this.isAutoTitle=!1,this.isOnlyForItemClass=!1,this.isOnlyForItemNotClass=!1,this.hasUrl=!1,this.element=t,
this.isAutoTitle=this.element.hasAttribute(i.ATTRIBUTE_AUTO_TITLE),this.isOnlyForItemClass=this.element.hasAttribute(i.ATTRIBUTE_ITEM_CLASS),this.isOnlyForItemNotClass=this.element.hasAttribute(i.ATTRIBUTE_ITEM_NOT_CLASS),this.itemClass=this.element.getAttribute(i.ATTRIBUTE_ITEM_CLASS),this.itemNotClass=this.element.getAttribute(i.ATTRIBUTE_ITEM_NOT_CLASS),this.keysParam=this.element.hasAttribute(i.ATTRIBUTE_PARAM_KEYS)?this.element.getAttribute(i.ATTRIBUTE_PARAM_KEYS):"ids",
this.hasUrl=this.element.hasAttribute(i.ATTRIBUTE_BASE_URL)}setCount(t){t>0?this.active():this.inactive()}updateUrl(t){this.element.setAttribute(i.ATTRIBUTE_URL,this.createUrl(t))}isActive(){return this.element.classList.contains("active")}isPost(){return this.element.classList.contains("action-post")}createUrl(t){var e={};return e[this.keysParam]=t,`${this.element.getAttribute(i.ATTRIBUTE_BASE_URL)}?${jQuery.param(e)}`}setTitle(t){
this.element.innerHTML=this.element.getAttribute(i.ATTRIBUTE_AUTO_TITLE)+" ("+t+")"}active(){this.element.classList.add("visible"),this.element.classList.remove("hidden")}inactive(){this.element.classList.remove("visible"),this.element.classList.add("hidden")}}i.ATTRIBUTE_AUTO_TITLE="data-base-title",i.ATTRIBUTE_ITEM_CLASS="data-item-class",i.ATTRIBUTE_ITEM_NOT_CLASS="data-item-not-class",i.ATTRIBUTE_PARAM_KEYS="data-param-keys",i.ATTRIBUTE_BASE_URL="data-base-url",i.ATTRIBUTE_URL="data-url"
;class s{constructor(t){this.selected=[],this.container=t,this.selected=this.getSelectedActions(),this.registerEvents()}registerEvents(){this.container.querySelector(this.getSelectAllSelector()).addEventListener("click",()=>this.onSelectAllClick()),this.container.querySelector(this.getSelectAllDropdownSelector()).addEventListener("click",()=>this.onSelectAllClick());this.container.querySelectorAll(this.getDeselectAllSelector());var t=this;$(this.getDeselectAllSelector()).each(function(){
$(this).on("click",function(){t.onDeselectAllClick()})})}getSelectAllSelector(){return".action-select-all"}getSelectAllDropdownSelector(){return".action-dropdown-select-all"}getDeselectAllSelector(){return".action-deselect-all"}getSelectedActions(){for(var t,e=this.container.querySelectorAll(".selected-actions .action"),i=[],s=0;t=e[s];s++)i.push(this.createAction(t));return i}createAction(t){return new i(t)}onSelectAllClick(){}onDeselectAllClick(){}}class a{constructor(t){this.element=t,
this.activeBtn=t.getElementsByClassName("selectedTotalAll")[0],this.inactiveBtn=t.getElementsByClassName("unselectedTotalAll")[0],this.registerEvents()}registerEvents(){this.activeBtn.addEventListener("click",()=>{this.element.classList.add("active"),this.element.dispatchEvent(new CustomEvent(a.EVENT_ACTIVE)),$(".mass-container").removeClass("mass-edit-active"),$(".mass-container").find(".with-checkbox").each(function(){$(this).addClass("selected"),
$(this).find("input.regular-checkbox")[0].checked=!0}),$(".action-dropdown-select-all").addClass("active"),$(".action-dropdown-deselect-all").removeClass("active")}),this.inactiveBtn.addEventListener("click",()=>{this.element.classList.remove("active"),this.element.dispatchEvent(new CustomEvent(a.EVENT_INACTIVE))});let t=this;$(".selectedTotalAll_helper").length&&$(".selectedTotalAll_helper").on("click",function(){clearTimeout(t.actionTimeout),
$(".action-deselect-all").length&&($(".action-deselect-all").trigger("click"),t.actionTimeout=setTimeout(function(){t.activeBtn.dispatchEvent(new Event("click"))},100))}),$(".unselectedTotalAll_helper").length&&$(".unselectedTotalAll_helper").on("click",function(){clearTimeout(t.actionTimeout),t.inactiveBtn.dispatchEvent(new Event("click"))})}show(){this.element.classList.remove("hidden")}hide(){this.element.classList.add("hidden"),this.element.classList.remove("active")}}
a.EVENT_ACTIVE="active",a.EVENT_INACTIVE="inactive",a.TOTAL_ITEMS_ACTIVE_CLASS="total-items-active";class n{constructor(t,e="item"){this.items=[],this.listID=t,this.itemClass=e,this.selectAll=this.getList().querySelector(".select-all-checkbox")}createItems(){for(var t,e=[],i=this.getList().querySelectorAll("."+this.itemClass+":not(.filter-radio-item)"),s=0;t=i[s];s++)e.push(this.createItem(t));return e}getList(){return document.getElementById(this.listID)}createItem(t){return new o(t)}init(){
this.items=this.createItems(),this.registerEvents()}registerEvents(){this.selectAll.addEventListener("click",()=>this.onSelectAllClick()),this.items.forEach(t=>{t.afterCheckboxChange=(()=>this.onItemCheckboxChanged(t))})}onSelectAllClick(){$(".mass-container").removeClass(a.TOTAL_ITEMS_ACTIVE_CLASS),this.selectAll.checked?this.checkedAll():this.uncheckedAll()}onItemCheckboxChanged(t){this.afterChange(t)}afterChange(t){}getTotalCount(){return this.items.length}getSelectedCount(){
return this.getSelectedList().length}getSelectedList(){return this.items.filter(t=>t.isSelected())}uncheckedAll(){$(".action-dropdown-select-all").addClass("active"),$(".action-dropdown-deselect-all").removeClass("active"),this.selectAll.classList.remove("used"),this.unselectItems()}unselectItems(){this.items.filter(t=>t.isSelected()).forEach(t=>{t.unselect()})}checkedAll(){$(".action-dropdown-select-all").removeClass("active"),$(".action-dropdown-deselect-all").addClass("active"),
this.selectItems(),this.selectAll.classList.remove("used"),this.selectAll.checked=!0}selectItems(){this.items.filter(t=>!t.isSelected()).forEach(t=>{t.select()})}static getKeys(t){return t.map(t=>t.key)}}class r extends n{createItem(t){return new l(t)}}class o{constructor(t){this.item=t,this.checkbox=this.findCheckbox(),this.key=this.item.getAttribute(this.getKeyAttributeName()),null!==this.checkbox&&this.registerEvent()}findCheckbox(){return this.item.querySelector('input[type="checkbox"]')}
registerEvent(){this.checkbox.addEventListener("change",()=>this.onCheckboxChange())}onCheckboxChange(){this.checkbox.checked?this.select():this.unselect()}afterCheckboxChange(t){}isInactive(){return this.hasClass(o.INACTIVE_CLASS)}isSelected(){return null!==this.checkbox&&isUndefined(this._isSelect)&&(this._isSelect=this.checkbox.checked),this._isSelect}select(){null!==this.checkbox&&(this.item.classList.add(o.SELECTED_CLASS),this.checkbox.checked=!0,this._isSelect=!0,
this.afterCheckboxChange(this))}unselect(){null!==this.checkbox&&(this.item.classList.remove(o.SELECTED_CLASS),this.checkbox.checked=!1,this._isSelect=!1,this.afterCheckboxChange(this))}hasClass(t){return this.item.classList.contains(t)}getKeyAttributeName(){return"data-key"}}o.INACTIVE_CLASS="inactive",o.SELECTED_CLASS="selected",t.CheckboxListItem=o;class l extends o{getKeyAttributeName(){return"data-container-game-id"}isOwned(){return this.hasClass(l.OWNED_CLASS)}isAlerted(){
return this.hasClass(l.ALERTED_CLASS)}}l.OWNED_CLASS="owned",l.ALERTED_CLASS="alerted"}(Widgets||(Widgets={})),function(t){var e=Utils.Interval,i=Helpers.Object.isEmpty,s=Widgets.Button.ActiveButtonTimeOut,a=Widgets.Timeago,n=Component.Alert.sweetAlert,r=Component.Alert.alertManager,o=Forms.updateCurrentListView;class l{constructor(t){this.statuses=[],this.inProgressSources={},this.lockedSources={},this.isChangingSources=!1,this.container=t,
this.minResyncTimeOutInSec=parseInt(this.container.getAttribute("data-refresh-interval")),this.inProgresInterval=new e(1500),this.inProgresInterval.handler=(()=>this.handleInProgressInterval()),this.lockedInterval=new e(300),this.lockedInterval.handler=(()=>this.handleLockedInterval()),this.init()}init(){this.statusUrl=this.getStatusUrl(),this.queueUrl=this.getQueueUrl()}refreshList(){document.body.classList.contains("empty-states-page")?location.reload():o()}getStatusUrl(){
return this.container.getAttribute("data-status-url")}getQueueUrl(){return this.container.getAttribute("data-queue-url")}createSource(t){return new c(t,this.container)}addInProgressSource(t){this.inProgressSources[t.sourceID]=t,this.inProgresInterval.start(!0)}addLockedSource(t){t.lock(),this.lockedSources[t.sourceID]=t,this.lockedInterval.start(!0)}addSourceToQueue(t){let e=this.createSource(t);e.btn.isDisabled()||(e.markAsLoading(),$.post(this.queueUrl,{source:t
}).done(()=>this.onAddToQueue(e)).fail(()=>l.onFailQueueAdding(e)))}onAddToQueue(t){t.markAsNew(),this.addInProgressSource(t),l.removeAlert(t),this.statuses=[]}static onFailQueueAdding(t){t.unmarkAsLoading(),n("Synchronization failed. Please try again later.")}handleInProgressInterval(){i(this.inProgressSources)?this.inProgresInterval.stop():this.isChangingSources||this.getStatuses()}handleLockedInterval(){if(i(this.lockedSources))this.lockedInterval.stop();else for(let t in this.lockedSources){
let e=this.lockedSources[t];e.isLocked()||(e.unlock(),delete this.lockedSources[e.sourceID])}}getStatuses(){this.isChangingSources=!0,$.get(this.statusUrl,t=>this.onGetStatuses(t))}onGetStatuses(t){if(0===t.code&&JSON.stringify(this.statuses)!==JSON.stringify(t.statuses)){this.statuses=t.statuses;for(let i in this.inProgressSources){switch(this.statuses[i]){case d.queued:this.inProgressSources[i].markAsQueued();break;case d.inProgress:this.inProgressSources[i].markAsProgress();break;case d.done:
var e=this.inProgressSources[i];this.onDone(e,t.lastSuccessAt[i],t.isPrivate[i])}}}this.isChangingSources=!1}onDone(t,e,i){t.markAsDone(),i?l.addAlert(t):(e=moment(e).format(),t.setLastSuccessAt(e),t.resyncTimeago.setTime(moment().add(this.minResyncTimeOutInSec,"seconds").toISOString()),this.addLockedSource(t),this.refreshList()),delete this.inProgressSources[t.sourceID],this.statuses=[],this.container.dispatchEvent(new CustomEvent("done.sourceConnections",{detail:{source:t,isPrivate:i}})),
jQuery(document).trigger("updateNotification")}static addAlert(t){r.addElement(t.getPrivateSourceAlert())}static removeAlert(t){r.remove(t.getAlertSelector())}}class c{constructor(t,e){this.sourceID=t,this.source=e.querySelector(this.getSourceSelector()),this.progressBar=new h(this.source.querySelector(".progressBar")),this.btn=new s(this.source.querySelector(".full-link")),
this.lastSyncTimeago=new a(this.source.querySelector(c.getLastSyncTimeagoSelector()),this.getSourceSelector()+" "+c.getLastSyncTimeagoSelector()),this.resyncTimeago=new a(this.source.querySelector(c.getResyncTimeagoSelector()),this.getSourceSelector()+" "+c.getResyncTimeagoSelector()),this.init()}getSourceSelector(){return".sync-"+this.sourceID}static getLastSyncTimeagoSelector(){return".last-text .timeago"}static getResyncTimeagoSelector(){return".locked-text .timeago"}init(){
this.btn.afterDisabled=(()=>this.afterBtnDisabled())}afterBtnDisabled(){this.resyncTime||(this.resyncTime=moment(this.resyncTimeago.getTime()))}getPrivateSourceAlert(){return this.source.querySelector(this.getAlertSelector()).cloneNode(!0)}getAlertSelector(){return".alert-source-"+this.sourceID}isLocked(){return moment().isBefore(this.resyncTime)}unlock(){this.btn.enabled(),this.source.classList.remove("locked")}lock(){this.source.classList.add("locked"),this.btn.disabled()}markAsNew(){
this.unmarkAsLoading(),this.source.classList.add("new")}unmarkAsNew(){this.source.classList.remove("new")}markAsQueued(){this.unmarkAsNew(),this.source.classList.add("queued"),this.progressBar.markQueued(),this.status=d.queued}markAsProgress(){status!==d.queued&&this.markAsQueued(),this.status=d.inProgress,this.source.classList.add("in-progress"),this.progressBar.markInProgress()}markAsDone(){status!==d.inProgress&&this.markAsProgress(),this.progressBar.markDone(),this.markAsLoading(),
setTimeout(()=>{this.source.classList.remove("in-progress"),this.source.classList.remove("queued"),this.unmarkAsLoading(),this.progressBar.unMarkAll()},500)}setLastSuccessAt(t){this.source.querySelector(".last-sync-time").classList.remove("not-synced-yet"),this.lastSyncTimeago.setTime(t)}markAsLoading(){this.source.classList.add("loading")}unmarkAsLoading(){this.source.classList.remove("loading")}}class h{constructor(t){this.queued=t.querySelector(".queued"),
this.inProgress=t.querySelector(".in-progress"),this.done=t.querySelector(".done")}markQueued(){h.markAsActive(this.queued)}markInProgress(){this.markQueued(),h.markAsActive(this.inProgress)}markDone(){this.markInProgress(),h.markAsActive(this.done)}unMarkAll(){h.unmarkAsActive(this.queued),h.unmarkAsActive(this.inProgress),h.unmarkAsActive(this.done)}static markAsActive(t){t.classList.add("active")}static unmarkAsActive(t){t.classList.remove("active")}}let d,u;function m(){
return u instanceof l||(u=new l(document.querySelector(".sync-widget"))),u}!function(t){t.queued="queued",t.inProgress="in-progress",t.done="done"}(d||(d={})),t.addInProgressSource=function(t){let e=m().createSource(t);m().addInProgressSource(e)},t.addLockedSource=function(t){let e=m().createSource(t);m().addLockedSource(e)},t.addSourceToQueue=function(t){m().addSourceToQueue(t)}}(SyncWidget||(SyncWidget={})),function(t){var e=Helpers.Object.isUndefined;class i{constructor(t,e){this.$parent=t,
e?(this.linksSelector=e.linksSelector||".nav li",this.tabsSelector=e.tabsSelector||".tab-pane"):(this.linksSelector=".nav li",this.tabsSelector=".tab-pane"),this.options=e,this.$tabs=this.findTabs(),this.$links=this.findLinks(),this.itemLength=this.$links.length,this.init()}init(){this.$links.on("shown.bs.tab",t=>this.onShownTab(t)),this.$links.on("show.bs.tab",t=>this.onShowTab(t))}findTabs(){return this.$parent.find(this.tabsSelector)}findLinks(){return this.$parent.find(this.linksSelector)}
getActiveTab(){return this.$tabs.filter(".active")}getActiveLink(){return this.$links.filter(".active")[0]}findTab(t){return this.$tabs.filter(t.attr("href"))}onShownTab(t){}onShowTab(t){}getTargetTab(t){var i=$(t.target);return e(i.attr("href"))?i:this.findTab(i)}}class s extends i{constructor(t,e){super(t,e),this.options={}}init(){this.options.onShown&&this.options.onShown(),super.init()}getClickedLink(){return this.clickedLink}onShownTab(t){super.onShownTab(t),
"function"==typeof this.options.onShown&&this.options.onShown(t,this)}onShowTab(t){this.clickedLink=t.target;var e=this.getTargetTab(t);let i=$(this.clickedLink).closest(".menu-item");$(this.clickedLink).closest(".nav").find(".menu-item").each(function(){$(this)!==i&&$(this).removeClass("active")}),0===e.html().trim().length&&(t.stopPropagation(),t.preventDefault(),this.loadData(e))}loadData(t){this.beforeAjaxLoad(),t.load(this.clickedLink.getAttribute("data-url"),(t,e)=>{
"error"!=e&&this.afterAjaxLoad()})}afterAjaxLoad(){this.getActiveTab().removeClass("loading");var t=$(this.clickedLink);t.tab("show"),"function"==typeof this.options.afterAjaxUpdate&&this.options.afterAjaxUpdate(this),t.trigger("dynamic.tab.loaded"),$(document).trigger("initTooltips")}beforeAjaxLoad(){this.getActiveTab().addClass("loading")}}t.DynamicTab=s;t.TitleDynamicTab=class extends s{constructor(t,e){super(t,e),this.longTitle=document.getElementById(e.longTitleId),
this.attributeTitleName=e.attributeTitle}onShownTab(t){super.onShowTab(t),this.longTitle.innerText=this.clickedLink.getAttribute(this.attributeTitleName)}}}(Widgets||(Widgets={}));var resizeTriggerTO,gamesLists={userAlertsIds:[],topAlertsIds:[],init:function(t,e){this.userContainerId=t,this.topContainerId=e,this.loadItems(e,this.topAlertsIds),this.loadItems(t,this.userAlertsIds)},reloadUserAlertsIds:function(){this.userAlertsIds=[],this.loadItems(this.userContainerId,this.userAlertsIds)},
reloadTopAlertsIds:function(){this.topAlertsIds=[],this.loadItems(this.topContainerId,this.topAlertsIds)},loadItems:function(t,e){e.length||$("#"+t).find(".item[data-id]").each(function(){e.push($(this).attr("data-id"))})},userHaveGamesFromTopAlerts:function(){return this.userAlertsIds.length!==array_diff(this.userAlertsIds,this.topAlertsIds).length}};function updateAlertsList(t){1!==gamesLists.userAlertsIds.length?(Forms.updateListView("alerts-list"),Component.Assets.reloadAlertsCss(),
gamesLists.reloadUserAlertsIds(),t&&gamesLists.userHaveGamesFromTopAlerts()&&(Forms.updateListView("top-alerts-list"),gamesLists.reloadUserAlertsIds())):location.reload()}function onAlertsPopupChange(t){Component.Popups.unlockAndHideAjaxModal(),document.body.classList.contains("user-alerts-page")?document.body.classList.contains("empty-states-page")?location.reload():updateAlertsList(!t):Component.Assets.reloadAlertsCss()}function refreshAlertsTable(t){
$("#"+t).find(".action-refresh").attr("data-success","updateAlertsList(false);").each(function(){var t=$(this);t.hasClass("action-remove")&&t.attr("data-success","updateAlertsList(true);")})}function initAlertsView(t,e,i){gamesLists.init(t,i),createMassManager(t,e)}function requestNotificationPermission(t,e){Component.Notifications.BrowserNotification.browserSupport()&&(Component.Notifications.BrowserNotification.isGranted()||Notification.requestPermission(function(i){
"granted"===i?Component.Alert.removeEnableBrowserPermissionAlert():t&&("denied"===i||Component.Notifications.isFirefox())&&swal({customClass:"enable-browser-notification with-image",title:"Browser notifications blocked",html:"Your browser is blocking our notifications.<br>Please enable them here:",imageUrl:e,imageAlt:"How to allow browser notifications.",showConfirmButton:!1,showCancelButton:!1})}))}function initBrowserPermissionAlert(t){
Component.Notifications.BrowserNotification.isGranted()||Component.Alert.alertManager.addAlertFromUrl(t)}function initDescriptionDotDot(){function t(t){new Dotdotdot(t,{keep:".read-more-btn",truncate:"letter",height:"watch"}).truncate()}for(var e,i=document.getElementsByClassName("ddd-truncate"),s=0;e=i[s];s++)t(e)}function catchEmptyLinks(t){$(t).find('a[href="#"]').on("click",function(t){t.preventDefault()})}function tabsFollowingBar_activate(t,e){
var i=t.closest(".following-tabs"),s=i.find(".following-bar"),a=i.offset().left,n=0,r=0;i.find(".following-tab").each(function(){$(this).find(".tab-link").attr("id")===t.attr("id")?(e||$(this).addClass("active"),n=$(this).innerWidth(),r=$(this).offset().left):e||$(this).removeClass("active")});var o=r-a;o=o<0?0:o,s.css({left:o+"px",width:n+"px"})}function tabsFollowingBar(t){t.each(function(){$(this).append('<span class="following-bar"></span>'),
tabsFollowingBar_activate($(this).find(".following-tab.active").find(".tab-link"),!1),$(this).on("click",".following-tab .tab-link",function(){tabsFollowingBar_activate($(this),!1)}),$(this).on("mouseenter",".following-tab .tab-link",function(){tabsFollowingBar_activate($(this),!0)}),$(this).on("mouseout",".following-tab .tab-link",function(){tabsFollowingBar_activate($(this).closest(".following-tabs").find(".following-tab.active .tab-link"),!0)})})}function resetDropdownFilter(t){
var e=$(t).closest(".filter"),i=e.closest('.filter[data-filter-type="filter-list"]'),s=e.closest(".filter-dropdown");if(e.find(".filter").length&&void 0!==$(this).attr("id"))e.find(".filter.active").each(function(){var t=$(this).attr("id");t=t.replace("-picker",""),$("#selected-filters").find('.filter[data-filter-id="'+t+'"]').trigger("click"),$(this).removeClass("active")}),e.find(".more").length&&(e.find(".more .turn-all-on").removeClass("disabled"),
e.find(".more .turn-all-off").addClass("disabled"));else if(e.hasClass("active")&&void 0!==e.attr("id")){var a=e.attr("id");$("#selected-filters").find('.filter[data-filter-id="'+a+'"]').trigger("click"),e.find(".filter.active").each(function(){var t=$(this).attr("id");$("#selected-filters").find('.filter[data-filter-id="'+t+'"]').trigger("click")})}if(e.find(".active-exclude").each(function(){$(this).removeClass("active-exclude")}),
e.hasClass("filter-part")&&e.find(".filter.active").each(function(){var t=$(this).attr("id");$("#selected-filters").find('.filter[data-filter-id="'+t+'"]').trigger("click")}),e.find(".filter-part").find(".filter.active").removeClass("active"),e.find(".radio-list.active").each(function(){var t=$(this).attr("id");$("#selected-filters").find('.filter[data-filter-id="'+t+'"]').trigger("click")}),e.find(".filter-switch-match-all").length){var n=e.find(".filter-match-all-trigger").find("input")
;n.val(""),n.trigger("change"),n[0].dispatchEvent(new Event("change")),n.val()===n.attr("data-unselect-value")?e.find(".filter-switch-match-all").removeClass("active"):e.find(".filter-switch-match-all").addClass("active")}i.length?i.find(".filter.active").length||(i.removeClass("active"),s.removeClass("active")):e.find("input").first().length&&""===e.find("input").first().val()&&(e.removeClass("active"),i.removeClass("active"),s.removeClass("active")),showResetFlash("Filter cleared","")}
function array_diff(t,e){return t.filter(function(t){return-1===e.indexOf(t)})}function updateURLParameter(t,e,i){var s="",a=t.split("?"),n=a[0],r=a[1],o="";if(r){a=r.split("&");for(var l=0;l<a.length;l++)a[l].split("=")[0]!==e&&(s+=o+a[l],o="&")}return n+"?"+s+(o+""+e+"="+i)}function closeFilters(t,e){e.preventDefault(),e.stopPropagation(),$("body").removeClass("open-filter full-overlay"),$(".filter-dropdown.open").removeClass("open"),$("#toast-container").length&&$("#toast-container").remove()
}function clearAllFiltersReset(){$(".main-filter-line").find(".filter-dropdown.active").removeClass("active"),$("#clear-all-filters").length&&($("#clear-all-filters").trigger("click"),$(".main-filter-line").find(".filter-dropdown.active").removeClass("active"))}function shopsFormChanged(){var t=parseInt($("#stores-keyshops-filter").find("input").val()),e=$("#stores-payment-filter").find("input").val().split(",").filter(t=>t),i=$("#stores-search-filter").find("input.search-input").val()
;$("#shops-list").find(".shop-item").removeClass("visible"),""!==i&&" "!==i&&i.length>=3?($("#selected-filters").find('[data-filter-id="search-by-main-name"]').find(".value .shop-name").text(i),$("#selected-filters").find('[data-filter-id="search-by-main-name"]').closest(".badge-wrapper").removeClass("hidden")):$("#selected-filters").find('[data-filter-id="search-by-main-name"]').closest(".badge-wrapper").addClass("hidden"),
e.length?(1===e.length?$("#selected-filters").find('[data-filter-id="stores-payment-filter"]').find(".value .payment-name").text(e[0]):$("#selected-filters").find('[data-filter-id="stores-payment-filter"]').find(".value .payment-name").text(e.length+" selected"),
$("#selected-filters").find('[data-filter-id="stores-payment-filter"]').closest(".badge-wrapper").removeClass("hidden")):$("#selected-filters").find('[data-filter-id="stores-payment-filter"]').closest(".badge-wrapper").addClass("hidden"),t?$("#selected-filters").find('[data-filter-id="stores-keyshops-filter"]').closest(".badge-wrapper").addClass("hidden"):$("#selected-filters").find('[data-filter-id="stores-keyshops-filter"]').closest(".badge-wrapper").removeClass("hidden"),
$("#shops-list").find(".shop-item").each(function(){var s=$(this).attr("data-payments-names").split(",");$(this).attr("data-name").toLowerCase().includes(i)&&$(this).addClass("visible"),e.length&&(e.some(t=>s.includes(t))&&$(this).attr("data-name").toLowerCase().includes(i)?$(this).addClass("visible"):$(this).removeClass("visible")),t||"1"!==$(this).attr("data-is-keyshop")||$(this).removeClass("visible")})
;var s=$("#selected-filters").find(".badge-wrapper:not(.hidden)").length,a=$("#shops-list").find(".shop-item").length;(s=s<0?0:s)>0?($("#selected-filters").removeClass("empty-desktop empty"),$("#shops-list").addClass("filtered"),a=$("#shops-list").find(".shop-item.visible").length,s>=2?$("#clear-all-filters").removeClass("hidden"):$("#clear-all-filters").addClass("hidden")):($("#selected-filters").addClass("empty-desktop empty"),$("#shops-list").removeClass("filtered")),
$("#stores-search-results-counter").find(".value").text(a+" result"+(1===a?"":"s")+"."),0===a?($("#shops-wrapper").addClass("hidden"),$("#empty-state").removeClass("hidden")):($("#shops-wrapper").removeClass("hidden"),$("#empty-state").addClass("hidden"))}function clearPaymentFilter(){$("#stores-payment-filter-dropdown").removeClass("active"),$("#stores-payment-filter").find("input").val(""),$("#stores-payment-filter").removeClass("active"),
$("#stores-payment-filter").find(".item").removeClass("active"),shopsFormChanged()}function clearAllShopFilters(){$("#selected-filters").find(".badge-wrapper:not(.hidden) .filter.remove-filter").each(function(){$(this).find(".remove-filter-icon").trigger("click")}),showResetFlash("All filters cleared","")}catchEmptyLinks("body"),$(function(){$.ajaxSetup({error:function(t){403===t.status&&showLoginPopUp()}}),$("#global-go-to-top").on("click",function(){$("html, body").animate({scrollTop:0},400)
}),Component.Popups.getAjaxModal(),Component.Tooltip.AutoHide.init(),initDescriptionDotDot()});var windowOldWidth=window.innerWidth;window.addEventListener("resize",function(){clearTimeout(resizeTriggerTO),resizeTriggerTO=setTimeout(function(){windowOldWidth!==window.innerWidth&&(windowOldWidth=window.innerWidth,window.dispatchEvent(new Event("afterWidthChange")))},200)})
;var $notificationsMenuDropdown=$(".menu-notifications-dropdown").first(),notificationListSelector="#notification-nav-items",$notificationDropdown=$("#notification-dropdown"),$notificationWrapper=$("#notification-dropdown-wrapper"),$notificationNavItems=$(notificationListSelector),$iconBtnNotification=$("#top-menu-link-notifications"),itemHeight=48,notificationLoader={startedLoadingNotifications:!1,enableMoreNotifications:!1,exceptNotificationsId:""},notification={
drodpownWrapper:document.getElementById("notification-dropdown-wrapper"),type:"",actionUrl:{updateCounter:$iconBtnNotification.attr("data-action-update"),loadItems:$notificationNavItems.attr("data-action")},minItemNanolimit:$notificationNavItems.attr("data-limit"),newNotificationsCount:parseInt($iconBtnNotification.find(".notifications-counter").text()),menuCounter:{$selector:$(".notifications-counter")},tabCounter:{update:function(t){0!==t?this.setTitle(t):this.setTitleWithoutCount()},
setTitleWithoutCount:function(){var t=document.title,e=/\(([^)]+)\)/.exec(t);null!==e&&(document.title=t.replace(e[0],""))},setTitle:function(t){var e=document.title,i=/\d+(?=\))/.exec(e);e=null!==i?e.replace(i[0],t):"("+t+") "+e,document.title=e}},markOverflow:function(t){t?notification.markAsOverflow():notification.unmarkAsOverflow()},markAsOverflow:function(){document.body.classList.add("notification-overflow")},unmarkAsOverflow:function(){
document.body.classList.remove("notification-overflow")},setMainCounters:function(t){this.tabCounter.update(t),$(".notifications-counter").text(t);var e="No new notifications";t>0?($iconBtnNotification.addClass("has-notifications"),e="<span>"+t+"</span></span> new notification"+(t>1?"s":"")):$iconBtnNotification.removeClass("has-notifications"),$iconBtnNotification.attr("title",'<span class="notifications-count simple-counter">'+e+"</span>")},itemList:{addItem:function(t){
$notificationNavItems.append(t)},getItem:function(t){return $notificationNavItems.find(this.getItemSelector(t))},getItemSelector:function(t){return'[data-key="'+t+'"]'},clearAll:function(){$notificationNavItems.html("")},getItems:function(){return $notificationNavItems.find(".item")},removeItem:function(t){var e=$(".notification-item"+this.getItemSelector(t));e.css({transition:"opacity .2s ease",opacity:0}),e.slideUp(250,function(){e.remove()})},bindOverflow:function(){
var t=this.getItems().find(".title");t.on("is-overflow",function(t){t.target.parentElement.classList.add("overflowed")}),t.on("not-overflow",function(t){t.target.parentElement.classList.remove("overflowed")})}},afterRemoveItem:function(t){this.itemList.removeItem(t),updateTimeIntervals(),this.itemList.getItems().length<=notification.minItemNanolimit?notificationLoader.loadNotifications(!1):this.totalNumber.decremental()},totalNumber:{$selector:$("#notifications-total-number"),set:function(t){
t>0?this.$selector.html(t):this.$selector.html("0")},decremental:function(){var t=parseInt(this.$selector.html());t>1&&(t--,this.set(t))}},isOpen:function(){return $notificationsMenuDropdown.hasClass("open")},updateList:function(){Forms.updateListView("notifications-list")},onClose:function(){notification.unmarkAsOverflow()},scroller:void 0,onListScroll:function(){let t=notification.getScrollValues();if(!1!==notificationLoader.enableMoreNotifications){let e=t.max-4*itemHeight
;t.scrollTop>e&&notificationLoader.loadNotifications(!1)}t.scrollTop>itemHeight?$notificationWrapper.addClass("scrolled"):$notificationWrapper.removeClass("scrolled")},getScrollValues:function(){let t=notification.scroller.scroll();return{scrollTop:t.position.y,max:t.max.y}}};notificationLoader.loadNotifications=function(t){!1===notificationLoader.startedLoadingNotifications&&(notificationLoader.startedLoadingNotifications=!0,$notificationWrapper.addClass("loading"),
!1===t?notificationLoader.exceptNotificationsId+=",":notificationLoader.exceptNotificationsId="",$.ajax({type:"GET",url:notification.actionUrl.loadItems,data:{type:notification.type,except:notificationLoader.exceptNotificationsId},dataType:"json",cache:!1,success:function(e){notification.setMainCounters(e.newNotificationsCount),notification.totalNumber.set(e.totalItemsCount);var i=e.items.length
;e.totalItemsCount>0?$notificationWrapper.addClass("active"):$notificationWrapper.removeClass("active");for(var s=0;s<i;s++){var a=e.items[s];notification.itemList.addItem(a.html),Component.Tooltip.AutoHide.parseElement(notification.itemList.getItem(a.id).find("[data-title-auto-hide]")[0]),notificationLoader.exceptNotificationsId+=a.id,s+1!==i&&(notificationLoader.exceptNotificationsId+=",")}setTimeout(function(){Helpers.Dom.executeScriptFromJson(e),jQuery(document).trigger("initTooltips"),
updateTimeIntervals()},100),notification.itemList.bindOverflow(),notificationLoader.enableMoreNotifications=e.more,notificationLoader.startedLoadingNotifications=!1,t&&$notificationWrapper.addClass("loaded"),$notificationWrapper.removeClass("loading")}}))};var BrowserNotification=Component.Notifications.BrowserNotification;function updateNewNotificationsCount(t){!notification.isOpen()&&t&&$.get(notification.actionUrl.updateCounter,function(t){
if(void 0!==t.count&&notification.newNotificationsCount!==t.count&&(notification.newNotificationsCount=t.count,notification.setMainCounters(t.count)),void 0!==t.items&&BrowserNotification.isGranted())for(var e=0;e<t.items.length;e++)BrowserNotification.pushNotification(t.items[e])})}function setNotificationInterval(t){setInterval(function(){updateNewNotificationsCount(!0)},t)}jQuery(document).on("updateNotification",function(){updateNewNotificationsCount(!0)})
;var $notificationsTypeFilter=$(".notifications-filter"),$notificationsTypeToggleBtn=$notificationsTypeFilter.find("button");function initScripts(t,e){var i=$(".init-"+t);return i.removeClass("init-"+t),e(i),i.addClass("initialised-"+t),i.length}function initGlobalScript(t,e){var i=$("body"),s="initialised-"+t;return!i.hasClass(s)&&(e(),i.addClass(s),!0)}$notificationsTypeFilter.find(".notification-filter").on("click",function(){var t=$(this)
;notification.type!==t.attr("data-type")&&($(".notification-filter").each(function(){$(this).removeClass("active")}),notification.type=t.attr("data-type"),t.addClass("active"),$(".notifications-filter .notifications-menu-dropdown-label").text(t.text()),notification.itemList.clearAll(),notificationLoader.loadNotifications(!0),t.closest(".dropdown").removeClass("open"))}),$notificationsTypeFilter.on("show.bs.dropdown",function(){
document.body.classList.add(Forms.Filter.FilterDropdown.BODY_CLASS_BLOCK_OPEN)}),$notificationsTypeFilter.on("hide.bs.dropdown",function(){setTimeout(function(){document.body.classList.remove(Forms.Filter.FilterDropdown.BODY_CLASS_BLOCK_OPEN)},300)}),$notificationDropdown.find("#notification-go-to-top").on("click",function(){return hideTooltip(),notification.scroller.scroll({y:"0%"},400),!1})
;var massManager,baseManager,INTERVAL_CLASS="time-interval",updateCurrentListView=Forms.updateCurrentListView;function createMassManager(t,e){massManager=new Widgets.GameMassActionsManager(t,e)}function createBaseMassManager(t,e){baseManager=new Widgets.MassActionsManager(t,e)}function updateTimeIntervals(){for(var t,e=document.getElementsByClassName(INTERVAL_CLASS),i=0;t=e[i];i++)if(!t.classList.contains("not-check")){var s=t.nextElementSibling
;s&&s.classList.contains(INTERVAL_CLASS)&&t.remove(),i>0&&e[i-1].textContent===t.textContent&&t.remove(),null===s&&t.remove()}}function initRemoveListViewItem(t){var e=document.getElementById(t),i=e.querySelectorAll(".action-remove");let s=e.querySelectorAll(".item").length;i.forEach(t=>t.addEventListener("swalActionSuccess",()=>{s>1?Forms.updateListView(e.id):location.reload()}))}function initCollectionsList(t,e){createMassManager(t,e),initRemoveListViewItem(e)}function initWishlistList(t,e){
createMassManager(t,e),initRemoveListViewItem(e),$("#"+t+" .wishlisted-game .deactivate").on("swalActionSuccess",updateCurrentListView)}function initIgnorelistList(t,e){createMassManager(t,e),initRemoveListViewItem(e),$("#"+t+" .ignored-game .deactivate").on("swalActionSuccess",updateCurrentListView)}const RELOAD_LIST_ID_WISHLIST="wishlist-list",RELOAD_LIST_ID_ALERTS="alerts-list",RELOAD_LIST_ID_COLLECTION="collection-list",RELOAD_LIST_ID_IGNORELIST="ignorelist-list"
;function reloadListFormAfterIgnore(t){if(t.closest("[data-form]").length){var e=t.closest("[data-form]").attr("id");if(""===Forms.getFilterFormValue(e,"showIgnored"))return Forms.updateListView(e),!0}return!1}function reloadListFormAfterUnignore(t){if(t.closest("[data-form]").length){var e=t.closest("[data-form]").attr("id");if(e===RELOAD_LIST_ID_IGNORELIST)return Forms.updateListView(e),!0}return!1}function reloadListFormAfterRemoveWishlist(t){if(t.closest("[data-form]").length){
var e=t.closest("[data-form]").attr("id");if(e===RELOAD_LIST_ID_WISHLIST)return Forms.updateListView(e),!0}return!1}function refreshGameDealsElements(t,e){$("#"+t+" .load-more-action").on("click",function(t){t.preventDefault();var i=document.getElementById(e);i.value=1,i.dispatchEvent(new Event("change"))})}function onCollectionPopupChange(){Component.Popups.unlockAndHideAjaxModal(),document.body.classList.contains("user-game-collection-page")&&Forms.updateListView("collection-list"),
Component.Assets.reloadCollectionCss()}function trimHoverBoxesTitles(){$(".games-hover-boxes").find(".game-hover-box .game-details-title .game-info-title").dotdotdot({keep:".game-active-icons",watch:".game-active-icons",callback:function(){updateTitleTooltips($(".games-hover-boxes"),!0)}})}function gameBoxEvents(){$(".game-item.cta-ext:not([data-initialized])").on("mouseover",".game-cta",function(){$(this).closest(".game-item").addClass("ext-hover")}),
$(".game-item.cta-ext:not([data-initialized])").on("mouseout",".game-cta",function(){$(this).closest(".game-item").removeClass("ext-hover")}),$(".list-more-wrapper:not([data-initialized])").on("click",".show-more-action",function(t){t.preventDefault(),t.stopPropagation(),$(this).closest(".list-more-wrapper").toggleClass("show-more")}),
$(".game-box-options:not([data-initialized]), .list-more-wrapper:not([data-initialized]), .game-item.cta-ext:not([data-initialized])").attr("data-initialized","true"),trimHoverBoxesTitles()}function trimNewsLead(t){t.each(function(){var t=$(this).find(".news-info-wrapper"),e=t.find(".news-title-wrapper"),i=e.find(".news-title > a"),s=t.find(".news-lead");i.dotdotdot({watch:!0,callback:function(){s.hasClass("ddd-truncated")&&s.dotdotdot({destroy:!0}),s.dotdotdot({watch:!1,
height:t.height()-e.outerHeight(!0)})}})})}var sidebarGameInfoTO,sidebarGameInfoUrl="";function sidebarGameInfoPin(){var t=$(window).scrollTop(),e=$(".col-with-dynamic-widget").first().offset().top,i=$(".col-with-dynamic-widget").first().offset().top+$(".col-with-dynamic-widget").height(),s=$(".game-info-dynamic-widget").height(),a=$("#main-menu").height()
;t+a>=e?t+s+a<i?$(".game-info-dynamic-widget-wrapper").removeClass("pinned-bottom").addClass("pinned"):$(".game-info-dynamic-widget-wrapper").addClass("pinned-bottom"):$(".game-info-dynamic-widget-wrapper").removeClass("pinned pinned-bottom")}function showSidebarGameInfo(t,e){var i=$(".game-info-dynamic-widget-wrapper");(sidebarGameInfoUrl!==t||e)&&(sidebarGameInfoUrl=t,i.removeClass("hidden"),i.addClass("loading"),i.attr("data-active-url",sidebarGameInfoUrl),$.ajax({url:t,success:function(t){
t.length&&(i.html(t),sidebarGameInfoPin(),i.removeClass("loading"))}}))}function sidebarGameInfoInit(){window.innerWidth>=1200&&initScripts("dynamicSidebar",function(t){t.each(function(){let t=$(this);t.on("mouseenter",".game-item-with-sidebar",function(){var t=$(this).attr("data-info-url");sidebarGameInfoTO=setTimeout(function(){showSidebarGameInfo(t,!1)},300)}),t.on("mouseleave",".game-item-with-sidebar",function(){clearTimeout(sidebarGameInfoTO)})})})}function gameInfoTitles_trim(){
return $(".games-box-tiles-wide, .games-list-layout").each(function(){var t=31;$(this).find(".game-item").first().height()>110&&(t=56),$(this).find(".game-info-title-wrapper .game-info-title:not(.ddd-truncated)").dotdotdot({height:t})}),!0}function loadMoreBoxEvents(){$(".load-more-container").each(function(){$(this).hasClass("load-more-container-initialized")||($(this).addClass("load-more-container-initialized"),$(this).on("click",".load-more-action",function(t){t.preventDefault()
;var e=$(this).attr("data-url"),i=$(this).closest(".load-more-container"),s=i.find(".load-more-content");if(!i.hasClass("show-more-limit")){i.addClass("loading");var a=!1;$.ajax({url:e,type:"post",success:function(t){if(t.length&&(i.hasClass("game-deals-container")&&(i.html(t),i.find(".load-more-content").unwrap(),i.addClass("show-more show-more-limit"),i.find(".btn-show-more-container").remove(),a=!0),
i.hasClass("game-related-container")||i.hasClass("related-news-container")||i.hasClass("game-bundles-container")||i.hasClass("game-recommended-container")||i.hasClass("discount-code-products-container"))){var e=$(t),n=e.find(".load-more-action").attr("data-url"),r=e.find(".load-more-content").html();s.find(".btn-show-more-container").remove(),s.append(r),a=!0,Helpers.Dom.executeScript(t),n?(i.find(".load-more-action").attr("data-url",n),
i.addClass("show-more")):(i.find(".btn-show-more-container").remove(),i.addClass("show-more-limit"))}i.removeClass("loading"),a&&($(document).trigger("initTooltips"),$(document).trigger("initCopyActions"),gameInfoTitles_trim(),gameBoxEvents())}})}}))})}function pinNewsSideBoxes(){if($("#best-deals-sidebar:visible").length){
var t=$(document).scrollTop(),e=$("#best-deals-sidebar"),i=e.closest(".widget-side-pin-wrapper").first().offset().top,s=e.closest(".col-news-content-right").offset().top+e.closest(".col-news-content-right").innerHeight(),a=$("#main-menu").innerHeight(),n=parseInt(e.css("margin-bottom"));t+e.innerHeight()+(a+24)<s-n?t>i-(a+24)?e.hasClass("pinned")&&!e.hasClass("bottom")||e.removeClass("bottom").addClass("pinned").css({top:a+24+"px"
}):e.removeClass("pinned bottom").removeAttr("style"):e.addClass("pinned bottom").removeAttr("style")}}function showPopUp(t){$(t+"-modal").modal("show")}var popHashes=new Utils.ArrayHashHandler(["#login-form","#coming"],showPopUp,{onClick:!0,onLoadTimeout:1,onLoad:!0,triggerName:"initModals",onePartHash:!0,preventDefault:!0,removeHash:!0});function showLoginPopUp(){showPopUp("#login-form")}function closePopup(){$.magnificPopup.close()}function scrollToAnchor(t,e){
var i=t?document.getElementById(t):null;if(null!==i){var s=$(i).offset().top-54;$("html, body").animate({scrollTop:s},e||400)}}$("[data-prevent-default]").on("click",function(t){t.preventDefault()}),$(".deals-page").on("shown.bs.modal","#ajax-modal.info-modal",function(){$(this).on("hidden.bs.modal",function(){setTimeout(function(){
$(".main-filter-line.filter-dropdown > .current").is(":visible")&&!$("body").hasClass("open-filter")&&$(".main-filter-line.filter-dropdown > .current").trigger("click")},50)})});var closeBtn,goToHash=new Utils.StringHashHandler("#goto-",scrollToAnchor,{onClick:!0,onLoad:!0,onLoadTimeout:1e3,onePartHash:!1,preventDefault:!1});function swalLinkSetCloseIcon(t){closeBtn='<div class="close-popup">\n<span class="close-box">'+t+"</span>\n</div>"}function initSwal(t){t.on("click",function(t){
var e="swal-posted";function i(t){t.classList.add(e);let i=t.getAttribute("data-url");i&&$.post(i).success(function(e){0!==e.code?(e.errors?console.log(e.errors.join("<br>")):console.log('Not found fields "errors" in action response: '+i),Component.Alert.sweetAlert()):(e.hasOwnProperty("__flashes")&&Helpers.Dom.executeScript(e.__flashes),t.dispatchEvent(new Event("swalActionSuccess")))}).fail(function(e){403!==e.status?Component.Alert.sweetAlert():t.classList.remove("loading")
}).always(function(){t.classList.remove(e)})}t.preventDefault(),t.stopImmediatePropagation();let s=t.currentTarget;if(s.hasAttribute("data-original-title")&&hideTooltip(),!s.classList.contains(e)&&!s.classList.contains("disabled"))if(s.hasAttribute("data-title")){var a=s.getAttribute("data-class"),n=s.getAttribute("data-body-class"),r=$("");n&&document.body.classList.add(n),s.hasAttribute("data-image")&&(r=$("<img>",{src:s.getAttribute("data-image"),class:"swal2-image"
})).appendTo($(".swal2-contentwrapper")),swal({title:s.getAttribute("data-title"),html:s.getAttribute("data-content-text"),confirmButtonText:s.getAttribute("data-confirm-btn-text"),customClass:a}).then(function(t){n&&setTimeout(function(){document.body.classList.remove(n)},300),$(".swal2-popup").prepend(r),t.value?i(s):$(".loading").removeClass("loading")})}else i(s)})}svg4everybody(),swal.setDefaults({showCancelButton:!0,showCloseButton:!0,cancelButtonText:"Cancel",
cancelButtonClass:"btn btn-grey-light",cancelButtonColor:"transparent",confirmButtonClass:"btn active btn-red",confirmButtonText:"Yes",onOpen:function(t){t.querySelector(".swal2-close").innerHTML=closeBtn}});var timeagoShortDictionary=function(t,e){
return[["just now","right now"],["%ss ago","in %ss"],["1m ago","in 1m"],["%sm ago","in %sm"],["1h ago","in 1h"],["%sh ago","in %sh"],["1d ago","in 1d"],["%sd ago","in %sd"],["1w ago","in 1w"],["%sw ago","in %sw"],["1mo ago","in 1mo"],["%smo ago","in %smo"],["1yr ago","in 1yr"],["%syr ago","in %syr"]][e]},timeagoFullDictionary=function(t,e){
return[["just now","right now"],["%s seconds ago","in %s seconds"],["1 minute ago","in 1 minute"],["%s minutes ago","in %s minutes"],["1 hour ago","in 1 hour"],["%s hours ago","in %s hours"],["1 day ago","in 1 day"],["%s days ago","in %s days"],["1 week ago","in 1 week"],["%s weeks ago","in %s weeks"],["1 month ago","in 1 month"],["%s months ago","in %s months"],["1 year ago","in 1 year"],["%s years ago","in %s years"]][e]};timeago.register("en_full",timeagoFullDictionary),
timeago.register("en_short",timeagoShortDictionary);var timeagoInstance=timeago(),toastrOptions={};function setToastrOptions(t){toastrOptions=t}function showInfoFlash(t,e){toastr.info(t,e,toastrOptions)}function showResetFlash(t,e){toastr.info(t,e,{closeButton:!1,hideDuration:0,positionClass:"toast-clear-filter toast-bottom-center",progressBar:!0,progressBarSideMargin:0,showDuration:300,timeOut:2e3})}var destTooltipsTO,hideTooltipTO,tippyOptions={allowTitleHTML:!1,arrow:!0,
arrowTransform:"scale(0.75)",dynamicTitle:!0,distance:13};function updateTitleTooltips(t,e){clearTimeout(destTooltipsTO),destTooltipsTO=setTimeout(function(){if(!t.length)return!1;t.find("[data-original-title]").each(function(){if(""!==$(this).attr("data-original-title")){var t=$(this).attr("data-original-title");$(this).removeClass("tippy-initialized").removeAttr("data-original-title").attr("title",t)}void 0!==$(this)[0]._tippy&&$(this)[0]._tippy.destroy()}),
e&&($(document).trigger("initTooltips"),Component.Tooltip.AutoHide.autoHide())},250)}function hideTooltip(){for(var t=document.querySelectorAll(".tippy-popper"),e=0;e<t.length;e++){var i=t[e]._tippy;i.state.visible&&(i.popperInstance.disableEventListeners(),i.hide())}}jQuery(document).on("initTooltips",function(){$("body [title]:not([data-not-tippy]):not(.tippy-initialized)").each(function(){$(this).addClass("tippy-initialized"),tippy($(this)[0],tippyOptions)})}),
jQuery(document).trigger("initTooltips"),window.addEventListener("scroll",hideTooltip),document.addEventListener("touchstart",function(){clearTimeout(hideTooltipTO),hideTooltipTO=setTimeout(hideTooltip,250)});var isRegisterSuccessClipboard=!1;function initMainPageGamesSlider(t,e,i,s){new Swiper("#"+t,{loop:!1,autoplay:!1,speed:e,preloadImages:!1,lazy:{loadOnTransitionStart:!0,loadPrevNext:!1},freeMode:!0,freeModeMomentumBounce:!1,spaceBetween:16,slidesPerView:"auto",pagination:!1,scrollbar:{
el:".slider-scrollbar",draggable:!0,hide:!1,snapOnRelease:!1},navigation:{nextEl:".swiper-buttons-wrapper .swiper-button-next",prevEl:".swiper-buttons-wrapper .swiper-button-prev"},resizeObserver:!0,breakpoints:{1280:{slidesPerGroup:s,slidesPerView:s,freeMode:!1,allowTouchMove:!1,spaceBetween:24},1120:{slidesPerGroup:4,freeMode:!1,spaceBetween:24}},on:{resize:function(t){t.slideTo(0,0,!1)},init:function(){
$("#mp-pop-games-slider .swiper-wrapper").find(".swiper-slide .game-info-wrapper .game-info-title-wrapper .title").dotdotdot({watch:!0,keep:".game-active-icons",callback:function(){updateTitleTooltips($("#mp-pop-games-slider .swiper-wrapper"),!0)}})}}})}jQuery(document).on("initCopyActions",function(){jQuery(document).on("click",".copy-code-action",function(t){t.stopImmediatePropagation(),t.preventDefault()});var t=new Clipboard(".copy-code-action")
;isRegisterSuccessClipboard||(t.on("success",function(t){showInfoFlash("Copied to clipboard."),t.clearSelection()}),isRegisterSuccessClipboard=!0)}),$(function(){var t,e=-20;function i(t){var e="notifications-opened user-menu-opened menu-more-opened";return e=t?e+" menu-opened":e,$("html, body").removeClass(e),$(".notification-item.options-opened").removeClass("options-opened"),!0}function s(){return i(!0),$(".bottom-mobile-screen-wrapper").removeClass("active"),
$("html, body").addClass("search-opened"),!1}function a(){return $("html, body").removeClass("search-opened"),$("#global-search-input").val("").blur(),$("#search-results").removeClass("results-shown"),!1}function n(){$(document).scrollTop()>$("#main-menu-wrapper").offset().top?($("#main-menu-wrapper").addClass("menu-pinned"),$(".settings-menu-dropdown").removeClass("open")):$("#main-menu-wrapper").removeClass("menu-pinned")}function r(){
var t=$(".top-menu").first().find(".top-menu-list").first(),i=$(".top-menu").first().find(".top-menu-hover-bar");i.css("left",e+"px"),t.find(".top-menu-list-item:not(.menu-list-home).active").length&&!t.find(".top-menu-list-item:not(.menu-list-home).active").parent().hasClass("top-menu-list-more")||i.removeClass("visible")}function o(t){var i=e;if($(".top-menu").first().find(".top-menu-hover-bar").length&&$(window).width()>=1030){
var s=$(".top-menu").first().find(".top-menu-list").offset().left,a=$(".top-menu").first().find(".top-menu-hover-bar"),n=a.width();return a.addClass("visible"),i=t.offset().left-s+(t.outerWidth()/2-n/2),a.css("left",i+"px"),i}return e}function l(){if($(".top-menu").first().find(".top-menu-hover-bar").length&&$(window).width()>=1030){var t=$(".top-menu").first().find(".top-menu-list").first();if(t.find(".top-menu-list-item:not(.menu-list-home).active").length){
var i=t.find(".top-menu-list-item:not(.menu-list-home).active");i.parent().hasClass("top-menu-list-more")||(e=o(i))}t.hasClass("top-menu-hover-bar-initialized")||(t.addClass("top-menu-hover-bar-initialized"),t.on("mouseenter",".top-menu-list-item:not(.menu-list-home):not(.more)",function(){o($(this))}),t.on("mouseenter",".top-menu-list-item.more, .top-menu-list-item.more .top-menu-list-more .top-menu-list-item",function(){r()}),t.on("mouseleave",function(){r()}))}return!1}function c(t){
var e=t.attr("data-search-tab");return $("#search-results-main").attr("data-active-tab",e),t.closest(".search-results-tabs").attr("data-search-active-tab",e),t.closest(".search-results-tabs").find("li").each(function(){$(this).attr("data-search-tab")===e?$(this).addClass("active"):$(this).removeClass("active")}),!1}$(".gg-theme-switcher").on("click",function(){"dark"===localStorage.getItem("theme")?localStorage.setItem("theme","light"):localStorage.setItem("theme","dark"),
$(this).addClass("selected").blur(),switchTheme()}),$(".gg-theme-switcher").on("mouseleave",function(){$(this).removeClass("selected")}),setInterval(function(){themeLS!==localStorage.getItem("theme")&&switchTheme()},5e3),$(".top-menu-list-item.more").on("shown.bs.dropdown",function(){i(!0),$("html, body").addClass("menu-more-opened")}),$(".top-menu-list-item.more").on("hidden.bs.dropdown",function(){i(!0)}),
$("#global-search-form").on("click",".search-results-trending-list .search-results-trending-item .search-results-trending-link",function(t){t.preventDefault();var e=$(this).find("span").text();$("#global-search-input").val(e),$("#global-search-input").trigger("keypress")}),$(".top-search").on("click",".clear-search",function(){$(this).closest(".top-search").find(".search-input#global-search-input").focus()}),$("#global-search-form").on("click","#reset-global-search",function(){
$("#global-search-input").val(""),$("#search-results").removeClass("results-shown"),$("#global-search-input").trigger("keypress")}),$("#global-search-form").on("click",".search-results-tabs li",function(t){t.preventDefault(),c($(this))}),$("#global-search-form").on("click",".game-options-wrapper *",function(t){t.preventDefault()});var h,d=2,u=!1,m=[9,20,19,33,34,35,36,44,45,144,145,16,18,91,93,37,38,39,40,112,113,114,115,116,117,118,119,120,121,122,123];function p(e){var i=e.keyCode||e.which
;if(-1===$.inArray(i,m)){clearTimeout(t);var n=$("#global-search-form").attr("data-search-games-url"),r=$("#global-search-form").attr("data-search-news-url"),o=$("#search-results"),l=o.find(".search-results-tabs");27!==i?13!==i?t=setTimeout(function(){var t=$("#global-search-input").val();u=!1,d=2,""!==t&&t.length>=3?(s(),o.addClass("loading"),$.ajax({type:"GET",url:n,data:{query:t},dataType:"json",cache:!1,success:function(e){if(d--,t.length>=3){u=!0
;var i='Games <span class="badge">'+e.totalResults+"</span>";l.find(".search-results-tab-games .search-results-tab").html(i),o.addClass("results-shown"),o.find("#search-results-main .search-results-col-games").html(e.items),Helpers.Dom.executeScript(e.__scripts)}}}),$.ajax({type:"GET",url:r,data:{query:t},dataType:"json",cache:!1,success:function(e){if(d--,t.length>=3){u=!0;var i='News <span class="badge">'+e.totalResults+"</span>";l.find(".search-results-tab-news .search-results-tab").html(i),
o.addClass("results-shown"),o.find("#search-results-main .search-results-col-news").html(e.items),Helpers.Dom.executeScript(e.__scripts)}}})):(o.find("#search-results-main .search-results-col-games").html(""),o.find("#search-results-main .search-results-col-news").html(""),d=0),function t(){h=setTimeout(function(){if(d<=0){clearTimeout(h),$("#search-results").removeClass("loading"),u||$("#search-results").removeClass("results-shown")
;var e=$(".search-results-tabs").find(".search-results-tab-games"),i=$(".search-results-tabs").find(".search-results-tab-news"),s=e.find(".search-results-tab .badge").text(),a=i.find(".search-results-tab .badge").text();e.hasClass("active")&&"0"===s&&"0"!==a&&c(i),i.hasClass("active")&&"0"===a&&"0"!==s&&c(e)}else t()},100)}()},200):$("#global-search-form").submit():a()}}$("#global-search-form").on("keypress keydown","#global-search-input",function(t){p(t)}),
$(".navbar-new").on("click",".top-mobile-menu-trigger",function(){i(!1),$("html, body").toggleClass("menu-opened"),$(".bottom-mobile-screen-wrapper").removeClass("active")}),$(".bottom-mobile-wrapper").on("click",".bottom-mobile-screen-link",function(t){t.preventDefault(),t.stopPropagation();var e=$(this).attr("data-mobile-screen-target");$(this).closest(".bottom-mobile-wrapper").find(".bottom-mobile-screen-wrapper").each(function(){if($(this).attr("data-mobile-screen-id")===e){
$(this).addClass("active");new OverlayScrollbars($(".bottom-mobile-screen-content"),{className:"os-theme-thin-dark",scrollbars:{autoHide:"l"},overflowBehavior:{x:"hidden"}})}else $(this).removeClass("active")})}),$(".bottom-mobile-screen-wrapper").on("click",".bottom-mobile-screen-back",function(t){t.preventDefault(),t.stopPropagation(),$(this).closest(".bottom-mobile-screen-wrapper").removeClass("active")}),$("#global-search-input").on("click keypress",function(){s()}),
$(".top-search").on("click",".search-close-btn",function(){a()}),$(window).on("load",function(){$("#global-search-input").is(":focus")&&s()}),$(document).on("click",function(t){var e=$(t.target);e.parents(".top-search").length||a(),e.parents(".top-menu").length||!$("html, body").hasClass("menu-opened")||e.closest(".main-menu-wrapper").find(".top-mobile-menu-trigger").length||$("html, body").removeClass("menu-opened")}),$(".menu-profile-dropdown").on("shown.bs.dropdown",function(){i(!0),
$("html, body").addClass("user-menu-opened"),$(".bottom-mobile-screen-wrapper").removeClass("active")}),$(".menu-profile-dropdown").on("hidden.bs.dropdown",function(){i(!0),$(".bottom-mobile-screen-wrapper").removeClass("active")}),$(".menu-profile-dropdown").on("click",".dropdown-menu",function(t){$(window).width()<1030&&t.stopPropagation()}),$(".menu-profile-dropdown").on("click",".bottom-mobile-screen-wrapper",function(t){t.stopPropagation()}),
$(".menu-notifications-dropdown").on("shown.bs.dropdown",function(){i(!0),$("html, body").addClass("notifications-opened"),notificationLoader.loadNotifications(!0),notification.scroller=new OverlayScrollbars($(".notifications-content-wrapper"),{className:"os-theme-thin-dark",scrollbars:{autoHide:"l"},overflowBehavior:{x:"hidden"},callbacks:{onOverflowChanged:function(t){notification.markOverflow(t.y)},onScroll:notification.onListScroll}})}),
$(".menu-notifications-dropdown").on("hidden.bs.dropdown",function(){i(!0),notification.itemList.clearAll(),$notificationWrapper.removeClass("loaded")}),$(".menu-notifications-dropdown").on("click",".notification-item-options-trigger",function(t){var e=$(this).closest(".notification-item").attr("data-key");$(this).closest(".notifications-container").find(".notification-item").each(function(){$(this).attr("data-key")===e?$(this).hasClass("options-opened")?($(this).removeClass("options-opened"),
$(this).find(".notification-item-options").removeClass("open")):($(this).addClass("options-opened"),$(this).find(".notification-item-options").addClass("open")):($(this).removeClass("options-opened"),$(this).find(".notification-item-options").removeClass("open"))}),t.stopPropagation(),t.preventDefault()}),$(".notifications-container").on("click",".notification-item .notification-item-options-trigger",function(t){var e=$(this).closest(".notification-item").attr("data-key")
;$(this).closest(".notifications-container").find(".notification-item").each(function(){$(this).attr("data-key")===e?$(this).hasClass("options-opened")?($(this).removeClass("options-opened"),$(this).find(".dropdown").removeClass("open")):($(this).addClass("options-opened"),$(this).find(".dropdown").addClass("open")):($(this).removeClass("options-opened"),$(this).find(".dropdown").removeClass("open"))}),t.stopPropagation(),t.preventDefault()}),
$(".menu-notifications-dropdown").on("click",".notifications-menu-filter",function(t){t.stopPropagation(),$(this).toggleClass("open")}),$(".menu-notifications-dropdown").on("click",".notifications-menu-filter .dropdown-menu .notification-filter",function(t){t.stopPropagation(),$(this).closest(".notifications-menu-filter").removeClass("open")}),
$(".menu-notifications-dropdown").on("click",".notifications-menu-top, .notifications-menu-bottom, .os-scrollbar, .os-scrollbar-handle, .time-interval",function(t){t.stopPropagation()}),$("body").on("click",".swal2-container, .popup-modal .modal-dialog",function(t){($(".menu-notifications-dropdown").hasClass("open")||$("body").hasClass("search-opened"))&&(t.stopPropagation(),$(".tippy-popper").remove())}),$(".menu-keyshops-switch").on("click",function(){
$(this).find(".switch").toggleClass("active")}),$(window).on("scroll",function(){n()}),n(),l(),$(window).on("afterWidthChange",function(){l()})});var initSideGalleryTO,game_gallerySide,mainPage_gallery=[],mainPage_gallerySlideIndex=[];function initMainPageGallery(t,e){$("#"+t).length&&(mainPage_gallery[t]=new Swiper("#"+t,{loop:!0,loopedSlides:0,autoplay:!1,speed:500,preloadImages:!1,lazy:{loadOnTransitionStart:!0,loadPrevNext:!1},effect:"fade",navigation:{nextEl:".swiper-button-next",
prevEl:".swiper-button-prev"},pagination:{el:".swiper-navigation-mp-wrapper .swiper-pagination",dynamicBullets:!1,clickable:!0,hideOnClick:!1},breakpoints:{1200:{pagination:{dynamicBullets:!1,clickable:!1,loop:!1}},620:{pagination:{dynamicBullets:!1,clickable:!0,loop:!1}}},on:{init:function(e){var i=0;mainPage_gallerySlideIndex[t]=1,$(e.slides).each(function(){$(this).hasClass("swiper-slide-duplicate")||i++}),
$("#"+t).find(".swiper-navigation-mp-wrapper .swiper-pager").find(".slide-page-total").text(i),$("#"+t).find(".swiper-navigation-mp-wrapper .swiper-pager").find(".swiper-pagination").attr("data-slides-total",i),$("#"+t).find(".swiper-slide-duplicate .timesince.initialised-timesince").length&&($("#"+t).find(".swiper-slide-duplicate .timesince.initialised-timesince").removeClass("initialised-timesince").addClass("init-timesince"),initScripts("timesince",function(t){
Utils.CountDownTimer.render(t.toArray())}))},afterInit:function(i){"true"===$("#"+t).attr("data-autoplay-enabled")&&(i.params.autoplay={delay:e,pauseOnMouseEnter:!0},i.autoplay.start())},slideChangeTransitionEnd:function(){$("#"+t).find(".swiper-navigation-mp-wrapper .swiper-pager").removeClass("prev-slide next-slide")},slideChange:function(e){$("#"+t).find(".swiper-navigation-mp-wrapper .swiper-pager").removeClass("prev-slide next-slide")
;var i=parseInt($("#"+t).find(".swiper-navigation-mp-wrapper .swiper-pager").find(".swiper-pagination").attr("data-slides-total")),s=e.realIndex+1,a="prev-slide";(s>mainPage_gallerySlideIndex[t]||1===s&&mainPage_gallerySlideIndex[t]===i)&&(a="next-slide"),1===mainPage_gallerySlideIndex[t]&&s===i&&i>2&&(a="prev-slide"),mainPage_gallerySlideIndex[t]=s,$("#"+t).find(".swiper-navigation-mp-wrapper .swiper-pager").addClass(a),
$("#"+t).find(".swiper-navigation-mp-wrapper .swiper-pager").find(".slide-page-current").text(s)}}}),$("#"+t).on("mouseenter",function(){mainPage_gallery[t].autoplay.stop()}),$("#"+t).on("mouseleave",function(){"true"===$("#"+t).attr("data-autoplay-enabled")&&mainPage_gallery[t].autoplay.start()}))}function updateMainPageGallery(){$(window).on("afterWidthChange",function(){$(".swiper-mp").each(function(){var t=$(this).attr("id");mainPage_gallery[t].update()})})}function initSideGallery(t){
if(clearTimeout(initSideGalleryTO),$(".gallery-side").length){if($("#games-list").length&&!$("#games-list").find(".wrap_items").hasClass("list"))return!1;$(".gallery-side").hasClass("swiper-initialized")&&game_gallerySide.destroy(),initSideGalleryTO=setTimeout(function(){game_gallerySide=new Swiper(".gallery-side",{loop:!0,autoplay:{delay:5e3},speed:500,preloadImages:!1,lazy:{loadOnTransitionStart:!0,loadPrevNext:!0},spaceBetween:0,navigation:{nextEl:".swiper-button-next",
prevEl:".swiper-button-prev"},pagination:{el:".gallery-side .gallery-pagination",dynamicBullets:!0,clickable:!0,loop:!0},on:{transitionEnd:function(t){t.params.speed=500},touchStart:function(t){t.params.speed=400},transitionStart:function(t){t.params.speed=400}}})},t)}}function initNewsSummary(t){var e="",i="",s=0,a=0;t.closest("article.single-news-container").find(".news-content h2, .news-content h3").each(function(){
var t="news-summary-link",e="",n="news-summary--"+jQuery(this).text().replace(/[^a-z0-9_]+/gi,"-").replace(/^-|-$/g,"").toLowerCase();"H2"===jQuery(this).prop("tagName")&&(a=0,e=++s),"H3"===jQuery(this).prop("tagName")&&(a++,s>0?(t+=" news-summary-link-inner",e=s+"."+a):e=a),jQuery(this).attr("id",n),i+='<div class="news-summary-single"><a href="#'+n+'" class="'+t+'"><span class="news-summary-counter">'+e+".</span><span> "+jQuery(this).html()+"</span></a></div>"}),
""!==i&&(e='<div class="news-summary-content"><button class="news-summary-toggle"><span>Table of Contents</span></button><div class="news-summary-inner"> '+i+"</div></div>"),t.html(e),jQuery(window).width()>=992&&t.addClass("open"),t.on("click",".news-summary-toggle",function(){jQuery(this).closest(".news-summary").toggleClass("open")}),t.on("click",".news-summary-link",function(t){t.preventDefault();var e=jQuery(this).attr("href");jQuery([document.documentElement,document.body]).animate({
scrollTop:jQuery(e).offset().top-72},600)})}function scriptFilterRefresh(t,e){clearTimeout(ajaxFilterTO),t.val(e),ajaxFilterTO=setTimeout(function(){t.trigger("change"),t[0].dispatchEvent(new Event("change"))},500)}function filtersShortenInit(t){if(!t.hasClass(".visible-all")){var e=t.offset(),i=0,s=t.innerWidth(),a=t.find(".search-bar").length,n=t.find(".foldable-show-more-btn");if(a&&(i+=t.find(".search-bar").innerWidth()+12),t.find(".filter-dropdown").each(function(){i+=$(this).innerWidth()
}),!t.hasClass("visible-all")&&t.hasClass("initialised-foldableTagList")||(t.find(".filter-dropdown").each(function(){$(this).removeClass("hidden")}),n.removeClass("hidden")),i>s){var r=t.find(".filter-dropdown:not(.hidden):not(.foldable-element-keep)").first().offset().top;if(t.find(".filter-dropdown:not(.foldable-element-keep)").each(function(){$(this).removeClass("hidden"),
($(this).offset().top>r||$(this).offset().left+$(this).innerWidth()>e.left+s-n.innerWidth())&&$(this).addClass("hidden hidden-folded")}),n.offset().top>r)for(;n.offset().top>r;)$(t.find(".filter-dropdown:not(.hidden):not(.foldable-element-keep)").get().reverse()).first().addClass("hidden hidden-folded");t.find(".foldable-show-more-btn").remove(),$(t.find(".filter-dropdown:not(.hidden):not(.foldable-element-keep)").get().reverse()).first().after(n),n.removeClass("hidden")
}else!t.hasClass("visible-all")&&t.hasClass("initialised-foldableTagList")?n.removeClass("hidden"):n.addClass("hidden")}}function foldableTagList(t){t.each(function(){var t=$(this);filtersShortenInit(t),t.on("click",".foldable-show-more-btn",function(){$(this).closest(".filters-line-container").find(".filter-dropdown.hidden").removeClass("hidden"),$(this).closest(".filters-line-container").addClass("visible-all"),$(this).addClass("hidden")}),window.addEventListener("afterWidthChange",function(){
filtersShortenInit(t)})})}function filterMatchAll(t){t.each(function(){var t=$(this);t.on("click",function(t){t.stopImmediatePropagation()}),t.find(".filter-switch-match-all").on("click",function(e){e.stopImmediatePropagation();var i=t.find("input"),s=i.attr("data-unselect-value");i.val()===i.attr("data-select-value")?($(this).removeClass("active"),
$(this).closest(".filter.isDropdown").find(".list").length&&($(this).closest(".filter.isDropdown").find(".list .item.active").length+$(this).closest(".filter.isDropdown").find(".list .item.active-exclude").length||$(this).closest(".filter.isDropdown").removeClass("active"))):($(this).addClass("active"),$(this).closest(".filter.isDropdown").addClass("active"),s=i.attr("data-select-value"));scriptFilterRefresh(t.find("input"),s)})})}var ajaxSearchTO,ajaxFilterTO,ajaxItemHeight=49
;function ajaxSearchFilterList(t,e){$(".filters-line-container").on("focus","#"+t+" .search-input",function(){$(this).closest(".search").find(".more").addClass("hidden"),$(this).closest(".search").find(".clear-wrap").removeClass("hidden")}),$(".filters-line-container").on("focusout","#"+t+" .search-input",function(){$(this).closest(".search").find(".more").removeClass("hidden"),$(this).closest(".search").find(".clear-wrap").addClass("hidden")}),
$(".filters-line-container").on("keyup","#"+t+" .search-input",function(i){i.stopImmediatePropagation(),clearTimeout(ajaxSearchTO);var s=$(this).val();s.length?($(this).closest(".search").addClass("active"),$(this).addClass("not-empty")):($(this).closest(".search").removeClass("active"),$(this).removeClass("not-empty"));var a=400;s.length<=2&&(a=1e3),ajaxSearchTO=setTimeout(function(){$("#"+t).find(".empty-states .search-pattern").text(s),window.ajaxFilterListEl[e].update(!1)},a)})}
function onAjaxListScroll(t){var e=t.srcElement||t.originalTarget,i={y:e.scrollTop},s={y:$(e).find(".os-content").height()-$(e).height()||e.scrollTopMax},a=s.y-20*ajaxItemHeight,n=$(e).closest(".ajax-items-list").attr("data-list-name");i.y>a&&window.ajaxFilterListEl[n].update(!0),i.y>=s.y?$(e).closest(".ajax-items-list").addClass("scrolled"):$(e).closest(".ajax-items-list").removeClass("scrolled")}function AjaxFilterList(t,e){this.input=t,this.url=t.attr("data-url"),this.name=e,
this.scroller=void 0,this.moreResults=!1,this.filter=this.input.closest(".filter"),this.init=function(){this.input.closest(".filter").find(".ajax-items-list").attr("data-list-name",this.name),ajaxSearchFilterList(this.filter.attr("id"),this.name)},this.loadItems=function(t){t?(this.input.attr("data-page",1),this.update(!1)):this.update(!0)},this.scrollerBuild=function(){void 0===this.scroller&&(this.scroller=new OverlayScrollbars(this.input.closest(".filter").find(".ajax-items-list"),{
className:"os-theme-thin-dark",scrollbars:{autoHide:"l"},overflowBehavior:{x:"hidden"}}),this.scroller.options("callbacks.onScroll",onAjaxListScroll)),this.scroller.scroll(0)},this.update=function(t){var e="",i="",s=this.input.val().split(","),a=this.input,n=this.name,r='<span class="filter-checkbox">'+a.attr("data-checkbox-icon")+"</span>",o=a.attr("data-page"),l="",c="";if(""!==this.input.val()?(this.input.closest(".filter").addClass("active"),
i=this.input.val()):this.input.closest(".filter").removeClass("active"),""!==$('input[data-search-name="'+this.name+'"]').val()&&$('input[data-search-name="'+this.name+'"]').val().length>2&&(e=$('input[data-search-name="'+this.name+'"]').val()),this.filter.find(".list").hasClass("with-exclude")&&(c='<span class="filter-checkbox filter-checkbox-exclude after-filter"></span>',l=" item-with-exclude"),t||(o=1,a.removeClass("finished")),!a.hasClass("loading")&&!a.hasClass("finished")){
a.addClass("loading");var h={page:o};""!==i&&(h.selected=i),""!==e&&(h.query=e),$.ajax({type:"get",url:this.url,data:h,success:function(e){var i=a.closest(".filter").find(".ajax-items-list"),o=parseInt(a.attr("data-page")),h=e.results,d="";if(h.length){for(var u=0;u<h.length;u++){var m=-1!==s.indexOf(h[u].id)?" active":"",p=-1!==s.indexOf("-"+h[u].id)?" active-exclude":""
;d+='<div class="item filter-switch '+n+"-item flex-item "+m+p+l+'" data-id="'+h[u].id+'">'+r+'<span class="filter-name">'+h[u].name+'<span class="filter-name-counter">('+h[u].count+")</span></span>"+c+"</div>"}t?i.find(".os-content").length?i.find(".os-content").append(d):i.append(d):i.find(".os-content").length?i.find(".os-content").html(d):i.html(d),a.closest(".filter").find(".list").removeClass("hidden"),a.closest(".filter").find(".filter-disabled-info").addClass("hidden")
}else a.closest(".filter").find(".list").addClass("hidden"),a.closest(".filter").find(".filter-disabled-info").removeClass("hidden");t?e.more&&a.attr("data-page",o+1):(a.attr("data-page",2),window.ajaxFilterListEl[n].scrollerBuild()),e.more?a.removeClass("finished"):a.addClass("finished"),a.removeClass("loading")}})}}}function ajaxListDropdown(t){t.each(function(){var t=$(this).find(".filter").find('input[type="hidden"]').attr("id")
;window.ajaxFilterListEl[t]=new AjaxFilterList($('input[name="'+t+'"]'),t),window.ajaxFilterListEl[t].init(),$('input[name="'+t+'"]').closest(".filter-dropdown").on("open",function(){window.ajaxFilterListEl[t].loadItems(!0)}),$('input[name="'+t+'"]').closest(".filter").find(".list").on("click",".item",function(e){e.preventDefault(),e.stopImmediatePropagation();var i=$(this).attr("data-id"),s=$('input[name="'+t+'"]').val().split(",");$(this).toggleClass("active"),
$(this).removeClass("active-exclude");var a=(s=s.filter(function(t){return null!=t})).indexOf(i);if(a>-1)s.splice(a,1);else{s.push(i);var n=s.indexOf("-"+i);n>-1&&s.splice(n,1)}var r=s.join(",");","===r[0]&&(r=r.substring(1)),scriptFilterRefresh($('input[name="'+t+'"]'),r)}),$('input[name="'+t+'"]').closest(".filter").find(".list").on("click",".item .filter-checkbox-exclude",function(e){e.preventDefault(),e.stopImmediatePropagation()
;var i="-"+$(this).closest(".item").attr("data-id"),s=$('input[name="'+t+'"]').val().split(",");$(this).closest(".item").hasClass("active-exclude")?$(this).closest(".item").removeClass("active-exclude"):($(this).closest(".item").addClass("active-exclude"),$(this).closest(".item").removeClass("active"));var a=s.indexOf(i);if(a>-1)s.splice(a,1);else{s.push(i);var n=s.indexOf(i.substring(1));n>-1&&s.splice(n,1)}var r=s.join(",");","===r[0]&&(r=r.substring(1)),
scriptFilterRefresh($('input[name="'+t+'"]'),r)}),$('input[name="'+t+'"]').on("change",function(){""===$(this).val()?($(this).closest(".filter-dropdown").removeClass("active"),$(this).closest(".filter").removeClass("active"),$(this).closest(".filter").find(".list .item.active").each(function(){$(this).removeClass("active")}),window.ajaxFilterListEl[t].loadItems(!0)):($(this).closest(".filter-dropdown").addClass("active"),$(this).closest(".filter").addClass("active"))})})}
window.ajaxFilterListEl=[];
//# sourceMappingURL=main.js.map
